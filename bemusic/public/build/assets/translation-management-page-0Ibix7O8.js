import{$ as b,M as v,j as e,a0 as w,a1 as y,T as t,a2 as z,as as S,V as j,t as u,bx as N,r as x,ae as T,av as F,z as C,ar as D,ao as I,D as L,W as h,an as M,a4 as A,a5 as k,Q as f}from"./main-CUJEGI8U.js";import{u as B,a as V}from"./update-localization-BQ8pBl04.js";import{u as E}from"./index-B5ww1iWt.js";import{A as U}from"./Add-B3RL66ee.js";import{M as $}from"./MoreVert-BiULonS7.js";import{d as q}from"./download-file-from-url-BVaKcxRP.js";import{o as H}from"./open-upload-window-CboR35vP.js";import{D as P}from"./dialog-footer-jZcc-BBM.js";import{S as R}from"./section-helper-Dtpb8UEn.js";import{D as Q}from"./datatable-page-with-header-layout-C4e5sJMc.js";import{u as W}from"./use-required-params-Cp5Jywbp.js";import{u as O}from"./useSuspenseQuery-13TuSADp.js";import{B as Y,a as g}from"./breadcrumb-FXqyksUv.js";import{F as G}from"./file-input-config-DrcTpI3-.js";import"./uploaded-file-ksxfN_l-.js";import"./extension-from-filename-O0XMuZye.js";import"./dashboard-layout-context-DeTNv3yG.js";import"./useEffectEvent-pADbdn7r.js";import"./ChevronRight-BB6TpByg.js";import"./MoreHoriz-RUUnngeG.js";function J(){const{formId:o,close:s}=b(),i=v();return e.jsxs(w,{children:[e.jsx(y,{children:e.jsx(t,{message:"Add translation"})}),e.jsx(z,{children:e.jsxs(S,{form:i,id:o,onSubmit:r=>{s(r)},children:[e.jsx(R,{className:"mb-30",title:e.jsx(t,{message:"Add a new translation, if it does not exist already."}),description:e.jsx(t,{message:"This should only need to be done for things like custom menu items."})}),e.jsx(j,{inputElementType:"textarea",rows:2,autoFocus:!0,name:"key",label:e.jsx(t,{message:"Translation key"}),className:"mb-30",required:!0}),e.jsx(j,{inputElementType:"textarea",rows:2,name:"value",label:e.jsx(t,{message:"Translation value"}),required:!0})]})}),e.jsxs(P,{children:[e.jsx(u,{onClick:s,children:e.jsx(t,{message:"Cancel"})}),e.jsx(u,{variant:"flat",color:"primary",type:"submit",form:o,children:e.jsx(t,{message:"Add"})})]})]})}function be(){const{localeId:o}=W(["localeId"]),s=O(N.localizations.get(o)),[i,r]=x.useState(s.data.localization.lines||{}),d=T(),c=B(),[l,a]=x.useState("");return e.jsxs("form",{className:"flex h-full flex-col",onSubmit:n=>{n.preventDefault(),c.mutate({id:s.data.localization.id,lines:i},{onSuccess:()=>{d("/admin/localizations")}})},children:[e.jsx(Q,{showSidebarToggleButton:!0,title:e.jsxs(Y,{size:"xl",children:[e.jsx(g,{onSelected:()=>{d("/admin/localizations")},children:e.jsx(t,{message:"Localizations"})}),e.jsx(g,{children:e.jsx(t,{message:":locale translations",values:{locale:s.data.localization.name}})})]})}),e.jsx(K,{localization:s.data.localization,setLines:r,lines:i,searchQuery:l,setSearchQuery:a,isLoading:c.isPending}),e.jsx(X,{lines:i,setLines:r,searchQuery:l})]})}function K({localization:o,searchQuery:s,setSearchQuery:i,isLoading:r,lines:d,setLines:c}){const l=F(),{trans:a}=C();return e.jsx("div",{className:"flex-shrink-0 p-14 md:p-24",children:e.jsxs("div",{className:"flex items-center gap-32 md:gap-12",children:[e.jsx("div",{className:"max-w-440 flex-auto",children:e.jsx(D,{value:s,onChange:n=>i(n.target.value),startAdornment:e.jsx(I,{}),placeholder:a({message:"Type to search..."})})}),e.jsxs(L,{type:"modal",onClose:n=>{if(n){const m={...d};m[n.key]=n.value,c(m)}},children:[!l&&e.jsx(u,{className:"ml-auto",variant:"outline",color:"primary",startIcon:e.jsx(U,{}),children:e.jsx(t,{message:"Add new"})}),e.jsx(J,{})]}),e.jsx(Z,{locale:o}),e.jsx(u,{variant:"flat",color:"primary",type:"submit",disabled:r,children:l?e.jsx(t,{message:"Save"}):e.jsx(t,{message:"Save translations"})})]})})}function X({searchQuery:o,lines:s,setLines:i}){const r=x.useMemo(()=>Object.entries(s).filter(([l,a])=>{const n=o==null?void 0:o.toLowerCase();return!n||(l==null?void 0:l.toLowerCase().includes(n))||(a==null?void 0:a.toLowerCase().includes(n))}),[s,o]),d=x.useRef(null),c=E({count:r.length,getScrollElement:()=>d.current,estimateSize:()=>123});return e.jsx("div",{className:"flex-auto overflow-y-auto px-14 md:px-24",ref:d,children:e.jsx("div",{className:"relative w-full",style:{height:`${c.getTotalSize()}px`},children:c.getVirtualItems().map(l=>{const[a,n]=r[l.index];return e.jsx("div",{className:"absolute left-0 top-0 w-full",style:{height:`${l.size}px`,transform:`translateY(${l.start}px)`},children:e.jsxs("div",{className:"mb-10 rounded border md:mr-10",children:[e.jsxs("div",{className:"flex items-center justify-between gap-24 border-b px-10 py-2",children:[e.jsx("label",{className:"flex-auto text-xs font-semibold",htmlFor:a,children:a}),e.jsx(h,{size:"xs",className:"text-muted",onClick:()=>{const m={...s};delete m[a],i(m)},children:e.jsx(M,{})})]}),e.jsx("div",{children:e.jsx("textarea",{id:a,name:a,defaultValue:n,className:"block w-full resize-none rounded bg-inherit p-10 text-sm outline-none focus-visible:ring-2",rows:2,onChange:m=>{const p={...s};p[a]=m.target.value,i(p)}})})]})},a)})})})}function Z({locale:o}){const s=V();return e.jsxs(A,{children:[e.jsx(h,{variant:"outline",size:"sm",color:"primary",disabled:s.isPending,children:e.jsx($,{})}),e.jsxs(k,{children:[e.jsx(f,{value:"download",onSelected:()=>q(`api/v1/localizations/${o.id}/download`),children:e.jsx(t,{message:"Download"})}),e.jsx(f,{value:"upload",onSelected:async()=>{const i=await H({types:[G.json]});i.length==1&&s.mutate({localeId:o.id,file:i[0]})},children:e.jsx(t,{message:"Upload"})})]})]})}export{be as Component};
