import{u as w,P as h,j as e,T as t,t as m,aa as u,I as j,J as g,aK as f,aL as v,a3 as x,r as F,W as C,an as _,cq as q,Q as o,e as I,M as B,G as P,ag as R,b as U,q as A,ae as E,as as L,V as d,v as Q}from"./main-CUJEGI8U.js";import{B as D}from"./backstage-layout-Cll0bBLM.js";import{u as S}from"./use-social-login-PeP1qq51.js";import{r as K,F as M}from"./file-upload-provider-DWaB2xE4.js";import{u as z}from"./use-active-upload-BwzDBsep.js";import{D as y}from"./DocumentScanner-CjU3RFtx.js";import{p as T}from"./pretty-bytes-bO14ePu9.js";import{F as V}from"./select-Z9R0wV6S.js";import{u as $}from"./use-primary-artist-for-current-user-T_VfOjnm.js";import{D as G}from"./paginated-resources-BDxg6DLi.js";import{F as Y}from"./normalized-model-field-8T9JWy8W.js";import{F as J}from"./image-selector-GLpYAkj6.js";import"./uploaded-file-ksxfN_l-.js";import"./extension-from-filename-O0XMuZye.js";import"./traditional-BcYcLesO.js";import"./open-upload-window-CboR35vP.js";import"./combobox-end-adornment-B0xReOuL.js";import"./use-normalized-models-ClA2DWxP.js";import"./Edit-BRVJ8AkN.js";import"./skeleton-BmWW5Jc-.js";import"./AddAPhoto-y5pGVyq2.js";import"./file-input-config-DrcTpI3-.js";function O(){var l,p;const{social:s}=w(),{watch:a,setValue:r}=h(),{connectSocial:i}=S(),n=a("passportScan");return e.jsxs("div",{className:"py-20",children:[e.jsx("div",{className:"mb-14 text-sm",children:e.jsx(t,{message:"Speed up the process by connecting artist social media accounts or uploading your passport scan."})}),((l=s==null?void 0:s.twitter)==null?void 0:l.enable)&&e.jsx(m,{variant:"outline",startIcon:e.jsx(f,{className:"text-twitter"}),className:"mb-10 mr-10 md:mb-0",onClick:async()=>{const c=await i("twitter");(c==null?void 0:c.status)==="SUCCESS"&&(u.invalidateQueries({queryKey:["users"]}),j(g("Connected twitter account")))},children:e.jsx(t,{message:"Connect to twitter"})}),((p=s==null?void 0:s.facebook)==null?void 0:p.enable)&&e.jsx(m,{variant:"outline",startIcon:e.jsx(v,{className:"text-facebook"}),className:"mb-10 mr-10 md:mb-0",onClick:async()=>{const c=await i("facebook");(c==null?void 0:c.status)==="SUCCESS"&&(u.invalidateQueries({queryKey:["users"]}),j(g("Connected facebook account")))},children:e.jsx(t,{message:"Connect to facebook"})}),e.jsx(W,{}),e.jsxs("div",{className:"mt-20",children:[n&&e.jsx(N,{icon:e.jsx(y,{}),title:e.jsx(t,{message:"Passport scan"}),description:`${n.name} (${T(n.file_size)})`,onRemove:()=>{r("passportScan",void 0)}}),e.jsx(b,{service:"twitter"}),e.jsx(b,{service:"facebook"})]})]})}function b({service:s}){const{disconnectSocial:a}=S(),{data:r}=q("me",{with:["social_profiles"]}),i=r==null?void 0:r.user.social_profiles.find(n=>n.service_name===s);return i?e.jsx(N,{icon:s==="twitter"?e.jsx(f,{className:"text-twitter"}):e.jsx(v,{className:"text-facebook"}),title:e.jsx("span",{className:"capitalize",children:e.jsx(t,{message:":service account",values:{service:s}})}),description:i.username,isDisabled:a.isPending,onRemove:()=>{a.mutate({service:"twitter"},{onSuccess:()=>{u.invalidateQueries({queryKey:["users"]})}})}}):null}function N({icon:s,title:a,description:r,onRemove:i,isDisabled:n}){return e.jsxs("div",{className:"mb-8 flex items-center gap-8 rounded border px-14 py-8",children:[e.jsx("div",{className:"flex-shrink-0 text-muted",children:F.cloneElement(s,{size:"lg"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted",children:a}),e.jsx("div",{className:"text-sm",children:r})]}),e.jsx(C,{className:"ml-auto flex-shrink-0",onClick:()=>i(),disabled:n,children:e.jsx(_,{})})]})}function W(){const{setValue:s}=h(),{selectAndUploadFile:a}=z(),r=K({uploadType:x.backstageAttachments}),i=()=>{a({showToastOnRestrictionFail:!0,uploadType:x.backstageAttachments,restrictions:r,onSuccess:n=>{s("passportScan",n)}})};return e.jsx(m,{variant:"outline",startIcon:e.jsx(y,{className:"text-primary"}),onClick:()=>i(),children:e.jsx(t,{message:"Upload passport scan"})})}function H(){return e.jsxs(V,{name:"role",label:e.jsx(t,{message:"Role"}),selectionMode:"single",className:"mb-24",children:[e.jsx(o,{value:"artist",children:e.jsx(t,{message:"Artist"})}),e.jsx(o,{value:"agent",children:e.jsx(t,{message:"Agent"})}),e.jsx(o,{value:"composer",children:e.jsx(t,{message:"Composer"})}),e.jsx(o,{value:"label",children:e.jsx(t,{message:"Label"})}),e.jsx(o,{value:"manager",children:e.jsx(t,{message:"Manager"})}),e.jsx(o,{value:"musician",children:e.jsx(t,{message:"Musician"})}),e.jsx(o,{value:"producer",children:e.jsx(t,{message:"Producer"})}),e.jsx(o,{value:"publisher",children:e.jsx(t,{message:"Publisher"})}),e.jsx(o,{value:"songwriter",children:e.jsx(t,{message:"Songwriter"})})]})}function X(s){const{user:a}=I(),r=$(),i=s==="verify-artist"?r==null?void 0:r.id:null;return B({defaultValues:{artist_id:i,artist_name:a==null?void 0:a.name,name:a==null?void 0:a.name,image:(r==null?void 0:r.image)||(a==null?void 0:a.image),type:s,role:s==="claim-artist"?"artist":void 0}})}const k="backstage-request";function Z(s){return P({mutationFn:a=>ee(a),onSuccess:()=>{u.invalidateQueries({queryKey:G(k)})},onError:a=>R(a,s)})}function ee(s){var a;return U.post(k,{artist_name:s.artist_name,artist_id:s.artist_id,type:s.type,data:{name:s.name,image:s.image,role:s.role,company:s.company,passport_scan_id:(a=s.passportScan)==null?void 0:a.id}}).then(r=>r.data)}function ke(){const{pathname:s}=A(),a=s.split("/").pop();return e.jsx(D,{children:e.jsxs("div",{className:"mx-auto my-40 max-w-780",children:[e.jsx("h1",{className:"text-center text-3xl font-medium md:text-5xl",children:e.jsx(t,{message:"Tell us about yourself"})}),e.jsx(se,{requestType:a})]})})}function se({requestType:s}){const a=E(),r=X(s),i=Z(r);return e.jsx(M,{children:e.jsxs(L,{form:r,onSubmit:n=>{i.mutate(n,{onSuccess:l=>{a(`/backstage/requests/${l.request.id}/request-submitted`,{replace:!0})}})},children:[e.jsx(J,{name:"image",uploadType:x.artwork,variant:"avatar",previewSize:"w-160 h-160",className:"mx-auto my-30 max-w-max",disabled:s==="become-artist"}),s!=="become-artist"&&e.jsx(Y,{className:"mb-24",label:e.jsx(t,{message:"Select artist"}),name:"artist_id",endpoint:"search/suggestions/artist",queryParams:{listAll:"true",excludeSelf:"true"},disabled:s==="verify-artist"}),s==="become-artist"&&e.jsx(d,{required:!0,name:"artist_name",label:e.jsx(t,{message:"Your artist name"}),className:"mb-24"}),e.jsx(d,{required:!0,name:"name",label:e.jsx(t,{message:"Your name"}),className:"mb-24"}),s==="claim-artist"&&e.jsx(H,{}),e.jsx(d,{name:"company",label:e.jsx(t,{message:"Company (optional)"}),className:"mb-24"}),e.jsx(O,{}),e.jsxs("div",{className:"flex justify-between gap-24 border-t pt-34",children:[e.jsx(m,{variant:"raised",color:"white",elementType:Q,to:"..",relative:"path",className:"min-w-140",radius:"rounded-full",children:e.jsx(t,{message:"Go back"})}),e.jsx(m,{variant:"raised",color:"primary",type:"submit",className:"min-w-140",radius:"rounded-full",disabled:i.isPending,children:e.jsx(t,{message:"Submit request"})})]})]})})}export{ke as Component};
