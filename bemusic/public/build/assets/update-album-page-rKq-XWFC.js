import{z as h,ae as y,q as A,G as v,ag as P,I as F,J as I,aa as C,b as E,j as r,T as l,N as q,at as d,M as N,au as k}from"./main-CUJEGI8U.js";import{p as Q,A as S}from"./use-create-album-DFEJM1jz.js";import{g as c}from"./album-link-DwfnHHp7.js";import{D as U}from"./paginated-resources-BDxg6DLi.js";import{u as B}from"./use-album-permissions-_OgAnUnz.js";import{C as D}from"./crupdate-resource-layout-D1LYHbcS.js";import{u as b}from"./use-required-params-Cp5Jywbp.js";import{F as L,u as _}from"./file-upload-provider-DWaB2xE4.js";import{u as g}from"./useSuspenseQuery-13TuSADp.js";import{B as x,a as i}from"./breadcrumb-FXqyksUv.js";import"./FileUpload-CTBOdaGq.js";import"./Add-B3RL66ee.js";import"./DragHandle-CQHOqRgB.js";import"./Edit-BRVJ8AkN.js";import"./track-form-CLrfwlwm.js";import"./image-selector-GLpYAkj6.js";import"./use-active-upload-BwzDBsep.js";import"./open-upload-window-CboR35vP.js";import"./uploaded-file-ksxfN_l-.js";import"./extension-from-filename-O0XMuZye.js";import"./AddAPhoto-y5pGVyq2.js";import"./file-input-config-DrcTpI3-.js";import"./pretty-bytes-bO14ePu9.js";import"./generate-waveform-data-BFwf5N3g.js";import"./form-chip-field-ehb7ckkp.js";import"./input-DAWJLQiY.js";import"./chip-list-D0uDB84E.js";import"./genre-B_3ZyEC1.js";import"./form-normalized-model-chip-field-R33Z1aXc.js";import"./use-normalized-models-ClA2DWxP.js";import"./normalized-model-field-8T9JWy8W.js";import"./select-Z9R0wV6S.js";import"./combobox-end-adornment-B0xReOuL.js";import"./skeleton-BmWW5Jc-.js";import"./formatted-duration-2_MIaPa4.js";import"./use-current-date-time-BhbL04rR.js";import"./use-update-track-form-8K0330m0.js";import"./dialog-footer-jZcc-BBM.js";import"./confirmation-dialog-DVMbD2S1.js";import"./music-Bh2SQVZ2.js";import"./use-create-track-form-DdtXewgZ.js";import"./drag-preview-C1yWSaDk.js";import"./use-sortable-imA7wH2m.js";import"./getScrollParent--OCc5gFh.js";import"./useGlobalListeners-BeXr-yG1.js";import"./date-picker-CE2IMMIh.js";import"./use-date-formatter-m8TmZzOM.js";import"./DateFormatter-Dix9bfnP.js";import"./DateRange-Bhvye4F9.js";import"./use-base-date-picker-state-DaWG2IMs.js";import"./KeyboardArrowRight-CjTKdvdU.js";import"./datatable-page-with-header-layout-C4e5sJMc.js";import"./dashboard-layout-context-DeTNv3yG.js";import"./traditional-BcYcLesO.js";import"./useEffectEvent-pADbdn7r.js";import"./ChevronRight-BB6TpByg.js";import"./MoreHoriz-RUUnngeG.js";const z=a=>`albums/${a}`;function M(a,e){const{trans:s}=h(),o=y(),{pathname:n}=A();return v({mutationFn:t=>R(e,t),onSuccess:t=>{F(s(I("Album updated"))),C.invalidateQueries({queryKey:U("albums")}),n.includes("admin")?o("/admin/albums"):o(c(t.album))},onError:t=>P(t,a)})}function R(a,e){return E.put(z(a),Q(e)).then(s=>s.data)}function T(a){return r.jsx(L,{children:r.jsx(w,{...a})})}function w({showExternalFields:a=!0,breadcrumbs:e,navbar:s}){const{albumId:o}=b(["albumId"]),t=g(d.albums.get(o,"editAlbumPage")).data.album,{canEdit:f}=B(t),j=!!_(m=>m.activeUploadsCount),u=N({defaultValues:{image:t.image,name:t.name,release_date:t.release_date,artists:t.artists,genres:t.genres,tags:t.tags,description:t.description,spotify_id:t.spotify_id,tracks:t.tracks}}),p=M(u,t.id);return f?r.jsx(D,{form:u,onSubmit:m=>{p.mutate(m)},navbar:s,title:e??r.jsxs(x,{size:"xl",children:[r.jsx(i,{to:"/admin/albums",children:r.jsx(l,{message:"Albums"})}),r.jsx(i,{children:t.name})]}),isLoading:p.isPending||j,disableSaveWhenNotDirty:!0,children:r.jsx(S,{showExternalIdFields:a})}):r.jsx(k,{to:"/",replace:!0})}function Vt(){const{albumId:a}=b(["albumId"]),e=g(d.albums.get(a,"editAlbumPage"));return r.jsx("div",{className:"h-screen",children:r.jsx(T,{showExternalFields:!1,navbar:r.jsx(q,{className:"flex-shrink-0",color:"bg",darkModeColor:"bg"}),breadcrumbs:r.jsxs(x,{size:"xl",children:[r.jsx(i,{to:c(e.data.album),children:e.data.album.name}),r.jsx(i,{children:r.jsx(l,{message:"Edit"})})]})})})}export{Vt as BackstageUpdateAlbumPage,T as Component};
