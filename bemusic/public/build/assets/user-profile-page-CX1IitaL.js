import{e as g,z as P,G as v,ag as N,b as w,I as F,J as T,aa as k,at as h,b7 as C,j as e,am as _,$ as B,a7 as S,M as D,a0 as E,a1 as I,T as o,a2 as L,as as M,a3 as U,V as p,Q as V,t as x,v as m,D as $,u as q,cE as z,r as f,O as Q,cj as H,aF as R}from"./main-CUJEGI8U.js";import{P as O}from"./player-page-header-gradient-B98PHS1w.js";import{P as A}from"./player-page-suspsense-nQjKTdHX.js";import{B as G}from"./bullet-separated-items-DSt8aXIS.js";import{M as K,a as b}from"./media-page-header-layout-B2pd5UBI.js";import{U as J}from"./user-image-CEN5XkJA.js";import{P as W}from"./profile-links-form-D9bVZwzy.js";import{F as Y}from"./image-selector-GLpYAkj6.js";import{F as X}from"./file-upload-provider-DWaB2xE4.js";import{C as Z}from"./combobox-BECNHGKY.js";import{D as ee}from"./dialog-footer-jZcc-BBM.js";import{P as se}from"./profile-description-BORmvgtE.js";import{F as ae}from"./follow-button-CLIfB8Ne.js";import{E as oe}from"./Edit-BRVJ8AkN.js";import{P as te}from"./page-meta-tags-CEAowLoU.js";import{u as re}from"./use-required-params-Cp5Jywbp.js";import{u as ie}from"./useSuspenseQuery-13TuSADp.js";import{T as le,a as ne,b as c}from"./tabs-BVjOaE7L.js";import"./Star-CDg8HN-f.js";import"./Add-B3RL66ee.js";import"./use-active-upload-BwzDBsep.js";import"./open-upload-window-CboR35vP.js";import"./uploaded-file-ksxfN_l-.js";import"./extension-from-filename-O0XMuZye.js";import"./AddAPhoto-y5pGVyq2.js";import"./file-input-config-DrcTpI3-.js";import"./pretty-bytes-bO14ePu9.js";import"./traditional-BcYcLesO.js";import"./combobox-end-adornment-B0xReOuL.js";import"./use-linkified-string-DMs78B9_.js";import"./linkify-Cbuu_PPG.js";import"./default-meta-tags-Cim_8kSD.js";function me(s){const{user:r}=g(),{trans:i}=P();return v({mutationFn:t=>w.put("users/profile/update",t).then(l=>l.data),onSuccess:()=>{F(i(T("Profile updated"))),r&&k.invalidateQueries({queryKey:h.userProfile(r.id).details.queryKey})},onError:t=>N(t,s)})}function ce({children:s,...r}){const{field:{onChange:i,onBlur:t,value:l="",ref:u},fieldState:{invalid:d,error:a}}=C({name:r.name}),n={onSelectionChange:i,onBlur:t,selectedValue:l,defaultInputValue:l,invalid:d,errorMessage:a==null?void 0:a.message};return e.jsx(Z,{ref:u,..._(n,r),children:s})}function ue({user:s}){var d;const{close:r,formId:i}=B(),{data:t}=S(["countries"]),l=D({defaultValues:{user:{username:s.username??"",image:s.image},profile:{city:s.profile.city??"",country:s.profile.country??"",description:s.profile.description??""},links:s.links}}),u=me(l);return e.jsxs(E,{size:"xl",children:[e.jsx(I,{children:e.jsx(o,{message:"Edit your profile"})}),e.jsx(L,{children:e.jsx(M,{id:i,form:l,onSubmit:a=>u.mutate(a,{onSuccess:()=>r()}),children:e.jsxs(X,{children:[e.jsxs("div",{className:"items-start gap-30 md:flex",children:[e.jsx(Y,{label:e.jsx(o,{message:"Avatar"}),name:"user.image",uploadType:U.avatars,variant:"square",previewSize:"w-200 h-200",className:"max-md:mb-20",onChange:(a,n)=>{l.setValue("user.image",(n==null?void 0:n.url)??null),l.setValue("user.image_entry_id",(n==null?void 0:n.id)??null)}}),e.jsxs("div",{className:"flex-auto",children:[e.jsx(p,{name:"user.username",label:e.jsx(o,{message:"Username"}),className:"mb-24"}),e.jsxs("div",{className:"flex items-center gap-24",children:[e.jsx(p,{name:"profile.city",label:e.jsx(o,{message:"City"}),className:"mb-24 flex-1"}),e.jsx(ce,{className:"mb-24 flex-1",selectionMode:"single",name:"profile.country",label:e.jsx(o,{message:"Country"}),children:(d=t==null?void 0:t.countries)==null?void 0:d.map(a=>e.jsx(V,{value:a.name,children:a.name},a.code))})]}),e.jsx(p,{name:"profile.description",label:e.jsx(o,{message:"Description"}),inputElementType:"textarea",rows:4})]})]}),e.jsxs("div",{className:"mt-24",children:[e.jsx("div",{className:"mb-16 border-b pb-16",children:e.jsx(o,{message:"Your links"})}),e.jsx(W,{})]})]})})}),e.jsxs(ee,{children:[e.jsx(x,{type:"button",onClick:()=>{r()},children:e.jsx(o,{message:"Cancel"})}),e.jsx(x,{form:i,type:"submit",variant:"flat",color:"primary",disabled:u.isPending,children:e.jsx(o,{message:"Save"})})]})]})}function de({user:s,tabLink:r}){const{user:i}=g();return e.jsx(K,{image:e.jsx(J,{user:s,className:"rounded-full",showProBadge:!0}),title:s.name,subtitle:e.jsxs(G,{className:"z-20 mx-auto w-max text-sm text-muted",children:[s.followers_count&&s.followers_count>0?e.jsx(m,{to:r("followers"),className:"hover:underline",children:e.jsx(o,{message:":count followers",values:{count:s.followers_count}})}):null,s.followed_users_count&&s.followed_users_count>0?e.jsx(m,{to:r("following"),className:"hover:underline",children:e.jsx(o,{message:"Following :count",values:{count:s.followed_users_count}})}):null]}),actionsBar:e.jsxs("div",{className:"flex items-center justify-center md:justify-start",children:[e.jsx(ae,{user:s,variant:"flat",color:"primary",minWidth:null,className:b({isFirst:!0}),radius:"rounded-full"}),(i==null?void 0:i.id)===s.id&&e.jsx(pe,{user:s})]}),footer:e.jsx(se,{profile:s.profile,links:s.links})})}function pe({user:s}){return e.jsxs($,{type:"modal",children:[e.jsx(x,{variant:"outline",radius:"rounded-full",startIcon:e.jsx(oe,{}),className:b(),children:e.jsx(o,{message:"Edit"})}),e.jsx(ue,{user:s})]})}const y=["tracks","playlists","reposts","albums","artists","followers","following"];var j;(j=R().settings.player)!=null&&j.enable_repost||y.splice(2,1);function Ge(){return e.jsx(A,{children:e.jsx(xe,{})})}function xe(){const{userId:s}=re(["userId"]),{player:r}=q(),i=ie(h.userProfile(s).details),t=i.data.user,l=z("/user/:userId/:userName/:tabName"),u=(l==null?void 0:l.params.tabName)||"tracks",d=y.indexOf(u)||0,a=f.useCallback(n=>`/user/${t.id}/${t.name}/${n}`,[t]);return e.jsxs(e.Fragment,{children:[e.jsx(te,{query:i}),t.image&&e.jsx(O,{image:t.image}),e.jsxs("div",{className:"relative",children:[e.jsx(de,{user:t,tabLink:a}),e.jsxs(le,{className:"mt-48",isLazy:!0,selectedTab:d,children:[e.jsxs(ne,{children:[e.jsx(c,{elementType:m,to:a("tracks"),children:e.jsx(o,{message:"Liked tracks"})}),e.jsx(c,{elementType:m,to:a("playlists"),children:e.jsx(o,{message:"Public playlists"})}),(r==null?void 0:r.enable_repost)&&e.jsx(c,{elementType:m,to:a("reposts"),children:e.jsx(o,{message:"Reposts"})}),e.jsx(c,{elementType:m,to:a("albums"),children:e.jsx(o,{message:"Liked albums"})}),e.jsx(c,{elementType:m,to:a("artists"),children:e.jsx(o,{message:"Liked artists"})}),e.jsx(c,{elementType:m,to:a("followers"),children:e.jsx(o,{message:"Followers"})}),e.jsx(c,{elementType:m,to:a("following"),children:e.jsx(o,{message:"Following"})})]}),e.jsx("div",{className:"mt-24",children:e.jsx(f.Suspense,{fallback:e.jsx("div",{className:"flex min-h-124 items-center justify-center",children:e.jsx(H,{})}),children:e.jsx(Q,{context:t})})})]})]})]})}export{Ge as Component};
