import{b7 as I,j as n,R as C,am as S,a as $,bx as k,aP as P,r as A,T as f,b$ as F,d as b,ar as L,c0 as N}from"./main-CUJEGI8U.js";import{A as V,a as _}from"./accordion-BALGWyw-.js";import{S as v}from"./switch-4KDjemPX.js";import{L as w,a as E}from"./list-C96mDrnJ.js";import{u as T}from"./uc-first-pSl3nM3z.js";const q=C.forwardRef(({roleType:a,...s},r)=>{var d;const e=(d=$(k.permissions.index(a)).data)==null?void 0:d.permissions,[o,c]=P(s.value,[],s.onChange);if(!e)return null;const i=Q(e,o),l=m=>{const x=[...o],p=x.findIndex(u=>u.id===m.id);p>-1&&x.splice(p,1,m),c(x)};return n.jsx(A.Fragment,{children:n.jsx(V,{variant:"outline",ref:r,children:i.map(({groupName:m,items:x,anyChecked:p})=>n.jsx(_,{label:n.jsx(f,{message:y(m)}),startIcon:p?n.jsx(F,{size:"sm"}):void 0,children:n.jsx(w,{children:x.map(u=>{const j=o.findIndex(h=>h.id===u.id),g=j>-1;return n.jsxs("div",{children:[n.jsx(E,{onSelected:()=>{if(g){const h=[...o];h.splice(j,1),c(h)}else c([...o,u])},endSection:n.jsx(v,{tabIndex:-1,checked:g,onChange:()=>{}}),description:n.jsx(f,{message:u.description}),children:n.jsx(f,{message:u.display_name})}),g&&n.jsx(z,{permission:u,onChange:l})]},u.id)})})},m))})})});function z({permission:a,onChange:s}){var t;if(!((t=a==null?void 0:a.restrictions)!=null&&t.length))return null;const r=(e,o)=>{const c=N(a,i=>{const l=i.restrictions.find(d=>d.name===e);l&&(l.value=o)});s==null||s(c)};return n.jsx("div",{className:"px-40 py-20",children:a.restrictions.map((e,o)=>{const c=o===a.restrictions.length-1,i=n.jsx(f,{message:e.display_name?e.display_name:y(e.name)}),l=e.description?n.jsx(f,{message:e.description}):void 0;return e.type==="bool"?n.jsx(v,{description:l,className:b(!c&&"mb-30"),checked:!!e.value,onChange:d=>{r(e.name,d.target.checked)},children:i},e.name):n.jsx(L,{size:"sm",label:i,description:l,type:"number",className:b(!c&&"mb-30"),value:e.value||"",onChange:d=>{r(e.name,d.target.value===""?void 0:parseInt(d.target.value))}},e.name)})})}function M(a){const{field:{onChange:s,value:r=[],ref:t}}=I({name:a.name}),e={onChange:s,value:r};return n.jsx(q,{ref:t,...S(e,a)})}const y=a=>T(a.replace("_"," "));function Q(a,s){const r=[];return a.forEach(t=>{let e=r.find(c=>c.groupName===t.group);e||(e={groupName:t.group,anyChecked:!1,items:[]},r.push(e));const o=s.findIndex(c=>c.id===t.id);if(o>-1){const c={...t,restrictions:B(t.restrictions,s[o].restrictions)};e.anyChecked=!0,e.items.push(c)}else e.items.push(t)}),r}function B(a,s){return a==null?void 0:a.map(r=>{const t=s==null?void 0:s.find(e=>e.name===r.name);return t?{...r,value:t.value}:r})}export{M as F,Q as b,y as p};
