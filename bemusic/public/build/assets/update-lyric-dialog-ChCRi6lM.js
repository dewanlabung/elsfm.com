import{j as e,as as L,T as r,V as u,z as m,G as x,ag as y,I as j,J as p,aa as o,b as h,$ as g,M as f,a0 as b,a1 as F,a2 as C,t as c}from"./main-CUJEGI8U.js";import{D as k}from"./dialog-footer-jZcc-BBM.js";import{D as d}from"./paginated-resources-BDxg6DLi.js";import{F as w}from"./switch-4KDjemPX.js";import{F as S}from"./normalized-model-field-8T9JWy8W.js";function D({form:s,onSubmit:t,formId:a}){return e.jsxs(L,{id:a,form:s,onSubmit:i=>t(i),children:[e.jsx(S,{className:"mb-24",label:e.jsx(r,{message:"Track"}),name:"track_id",endpoint:"normalized-models/track",queryParams:{with:"artists,album"}}),e.jsx(w,{className:"mb-24",name:"is_synced",description:e.jsx(r,{message:"Whether lyric contains timestmaps"}),children:e.jsx(r,{message:"Synced"})}),s.watch("is_synced")?e.jsx(u,{name:"duration",type:"number",label:e.jsx(r,{message:"duration"}),className:"mb-24",required:!0,description:e.jsx(r,{message:"Lyric duration in seconds. If this duration does not match the duration of track that is being played, lyric sync will be disabled and plain lyrics will be shown instead."})}):null,e.jsx(u,{name:"text",label:e.jsx(r,{message:"Text"}),inputElementType:"textarea",rows:30})]})}function _(s){const{trans:t}=m();return x({mutationFn:a=>T(a),onSuccess:()=>{j(t(p("Lyric created"))),o.invalidateQueries({queryKey:d("lyrics")}),o.invalidateQueries({queryKey:d("tracks")})},onError:a=>y(a,s)})}function T(s){return h.post("lyrics",s).then(t=>t.data)}function U({trackId:s}){const{close:t,formId:a}=g(),i=f({defaultValues:{track_id:s,is_synced:!1}}),n=_(i);return e.jsxs(b,{size:"xl",children:[e.jsx(F,{children:e.jsx(r,{message:"Create new lyric"})}),e.jsx(C,{children:e.jsx(D,{formId:a,form:i,onSubmit:l=>{n.mutate(l,{onSuccess:()=>t()})}})}),e.jsxs(k,{children:[e.jsx(c,{onClick:()=>t(),children:e.jsx(r,{message:"Cancel"})}),e.jsx(c,{form:a,disabled:n.isPending,variant:"flat",color:"primary",type:"submit",children:e.jsx(r,{message:"Create"})})]})]})}function q(s){const{trans:t}=m();return x({mutationFn:a=>v(a),onSuccess:()=>{j(t(p("Lyric updated"))),o.invalidateQueries({queryKey:d("lyrics")}),o.invalidateQueries({queryKey:d("tracks")})},onError:a=>y(a,s)})}function v({id:s,...t}){return h.put(`lyrics/${s}`,t).then(a=>a.data)}function I({lyric:s}){const{close:t,formId:a}=g(),i=f({defaultValues:{id:s.id,track_id:s.track_id,text:s.text,is_synced:s.is_synced,duration:s.duration}}),n=q(i);return e.jsxs(b,{size:"xl",children:[e.jsx(F,{children:e.jsx(r,{message:"Update lyric"})}),e.jsx(C,{children:e.jsx(D,{formId:a,form:i,onSubmit:l=>{n.mutate(l,{onSuccess:()=>{t()}})}})}),e.jsxs(k,{children:[e.jsx(c,{onClick:()=>t(),children:e.jsx(r,{message:"Cancel"})}),e.jsx(c,{form:a,disabled:n.isPending,variant:"flat",color:"primary",type:"submit",children:e.jsx(r,{message:"Update"})})]})]})}export{U as C,I as U};
