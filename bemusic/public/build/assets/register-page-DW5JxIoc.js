import{ae as y,e as S,al as w,G as F,ag as P,cr as k,b as R,u as j,q as _,X as E,M as I,j as e,au as q,T as s,S as A,as as L,V as u,t as M,I as T,J as B,v as G,cC as U}from"./main-CUJEGI8U.js";import{G as D,A as O}from"./auth-layout-DsR6c8vX.js";import{u as V,C as z}from"./use-captcha-CvlSDTuW.js";import{L as f}from"./external-link-jlnQ3iTs.js";import{F as J}from"./checkbox-suk8vW77.js";import{S as Q}from"./social-auth-section-w7a5y1i8.js";import"./CheckBoxOutlineBlank-BgWeDdny.js";import"./use-social-login-PeP1qq51.js";import"./use-all-social-logins-disabled-CojrygKD.js";import"./envato-DNf8Um8t.js";import"./google-nUE0mIIg.js";import"./dialog-footer-jZcc-BBM.js";function X(a){const t=y(),{getRedirectUri:i}=S(),{inviteId:n}=w();return F({mutationFn:r=>H({invite_id:n,...r}),onSuccess:r=>{k(r.bootstrapData),r.status==="needs_email_verification"?t("/"):t(i(),{replace:!0})},onError:r=>P(r,a)})}function H(a){return R.post("auth/register",a).then(t=>t.data)}function me({inviteType:a,fields:t}){const{branding:i,registration:n,social:r}=j(),{captchaToken:l,captchaEnabled:g,resetCaptcha:b}=V("register"),{pathname:v}=_(),[d]=E(),o=v.includes("workspace")||!!a,C=d.get("redirectFrom")==="pricing",p=d.get("email")||void 0,x=I({defaultValues:{email:p}}),h=X(x);if(n!=null&&n.disable&&!o)return e.jsx(q,{to:"/login",replace:!0});let m=e.jsx(s,{message:"Create a new account"});o?m=e.jsx(s,{values:{siteName:i==null?void 0:i.site_name},message:"To join your team on :siteName, create an account"}):C&&(m=e.jsx(s,{message:"First, let's create your account"}));const N=e.jsx(s,{values:{a:c=>e.jsx(G,{className:f,to:"/login",children:c})},message:"Already have an account? <a>Sign in.</a>"});return e.jsx(D,{children:e.jsxs(O,{heading:m,message:N,children:[e.jsx(A,{children:e.jsx(s,{message:"Register"})}),e.jsxs(L,{form:x,onSubmit:async c=>{if(g&&!l){T.danger(B("Please solve the captcha challenge."));return}h.mutate({...c,captcha_token:l,invite_type:a},{onError:()=>b()})},children:[e.jsx(u,{className:"mb-32",name:"email",type:"email",disabled:!!p,label:e.jsx(s,{message:"Email"}),required:!0}),e.jsx(u,{className:"mb-32",name:"password",type:"password",label:e.jsx(s,{message:"Password"}),required:!0}),e.jsx(u,{className:"mb-32",name:"password_confirmation",type:"password",label:e.jsx(s,{message:"Confirm password"}),required:!0}),t,g&&e.jsx(z,{className:"mb-32"}),e.jsx(K,{}),e.jsx(M,{className:"block w-full",type:"submit",variant:"flat",color:"primary",size:"md",disabled:h.isPending,children:e.jsx(s,{message:"Create account"})}),e.jsx(Q,{isUsingInvite:o,dividerMessage:r!=null&&r.compact_buttons?e.jsx(s,{message:"Or sign up with"}):e.jsx(s,{message:"OR"})})]})]})})}function K(){const{registration:a}=j();return a!=null&&a.policies?e.jsx("div",{className:"mb-32",children:a.policies.map(t=>e.jsx(J,{name:t.id,className:"mb-4 block",required:!0,children:e.jsx(s,{message:"I accept the :name",values:{name:e.jsx(U,{unstyled:!0,className:()=>f,item:t})}})},t.id))}):null}export{me as RegisterPage};
