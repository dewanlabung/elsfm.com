import{z as A,G as f,H as D,I as w,J as i,aa as P,b as v,M as L,$ as S,j as e,a0 as E,a1 as N,T as s,a2 as O,as as B,V,t as g,r as C,at as I,S as W,ab as q,D as d,u as H,a8 as M,W as T,aw as Q,aM as x}from"./main-CUJEGI8U.js";import{P as _}from"./playlist-BqUIfvab.js";import{D as R}from"./paginated-resources-BDxg6DLi.js";import{D as U}from"./dialog-footer-jZcc-BBM.js";import{F as m,d as p,A as h,u as z,a as K,G,D as J,b as $,c as Y}from"./use-datatable-query-D9uebfzx.js";import{c as X,u as Z}from"./timestamp-filters-DydeeDDl.js";import{C as ee}from"./create-playlist-dialog-DeyZkjsM.js";import{U as te}from"./update-playlist-dialog-D3q_Y3lO.js";import{P as ae}from"./playlist-link-CLw6NzkW.js";import{N as j}from"./name-with-avatar-CpbvmPVO.js";import{D as se}from"./data-table-add-item-button-_qDHIKil.js";import{D as ie}from"./datatable-filters-DFYg3QEK.js";import{a as oe,D as re,b as le,c as ne}from"./datatable-page-with-header-layout-C4e5sJMc.js";import{T as me}from"./table-CgoYghfp.js";import{F as pe}from"./formatted-date-DzIPJwiH.js";import{F as de}from"./formatted-number-gsF1qEbc.js";import{E as ce}from"./Edit-BRVJ8AkN.js";import{P as ue}from"./Publish-wob_XvAQ.js";import{C as ye}from"./confirmation-dialog-DVMbD2S1.js";import"./FilterAlt-Cw-mRuQp.js";import"./form-normalized-model-chip-field-R33Z1aXc.js";import"./use-normalized-models-ClA2DWxP.js";import"./form-chip-field-ehb7ckkp.js";import"./input-DAWJLQiY.js";import"./chip-list-D0uDB84E.js";import"./accordion-BALGWyw-.js";import"./checkbox-suk8vW77.js";import"./CheckBoxOutlineBlank-BgWeDdny.js";import"./ArrowRightAlt-iO8zeT1U.js";import"./DateRange-Bhvye4F9.js";import"./use-base-date-picker-state-DaWG2IMs.js";import"./use-date-formatter-m8TmZzOM.js";import"./DateFormatter-Dix9bfnP.js";import"./KeyboardArrowRight-CjTKdvdU.js";import"./use-date-range-picker-state-CSWp3d1-.js";import"./list-C96mDrnJ.js";import"./switch-4KDjemPX.js";import"./is-tablet-media-query-DhMPnSWn.js";import"./use-current-date-time-BhbL04rR.js";import"./select-Z9R0wV6S.js";import"./combobox-end-adornment-B0xReOuL.js";import"./normalized-model-field-8T9JWy8W.js";import"./skeleton-BmWW5Jc-.js";import"./image-selector-GLpYAkj6.js";import"./file-upload-provider-DWaB2xE4.js";import"./uploaded-file-ksxfN_l-.js";import"./extension-from-filename-O0XMuZye.js";import"./pretty-bytes-bO14ePu9.js";import"./traditional-BcYcLesO.js";import"./use-active-upload-BwzDBsep.js";import"./open-upload-window-CboR35vP.js";import"./AddAPhoto-y5pGVyq2.js";import"./file-input-config-DrcTpI3-.js";import"./Image-DWFqsH18.js";import"./Add-B3RL66ee.js";import"./dashboard-layout-context-DeTNv3yG.js";import"./ArrowDownward-BHYKFIfy.js";import"./useInteractOutside-BFJZ3Z5N.js";import"./useEffectEvent-pADbdn7r.js";import"./is-ctrl-or-shift-pressed-Bx-mqgCW.js";import"./use-pointer-events-DcvSqvAc.js";import"./useGlobalListeners-BeXr-yG1.js";const ge=""+new URL("playlist-Cez5d1CJ.svg",import.meta.url).href;function xe(){const{trans:t}=A();return f({mutationFn:a=>he(a),onSuccess:()=>{w(t(i("Playlist imported"))),P.invalidateQueries({queryKey:R("playlists")})},onError:a=>D(a)})}function he(t){return v.post("import-media/single-item",{modelType:_,spotifyId:t.spotifyId}).then(a=>a.data)}function je(){const t=L(),{formId:a,close:o}=S(),r=xe();return e.jsxs(E,{children:[e.jsx(N,{children:e.jsx(s,{message:"Import playlist"})}),e.jsx(O,{children:e.jsx(B,{id:a,form:t,onSubmit:l=>{r.mutate(l,{onSuccess:u=>{o(u.playlist)}})},children:e.jsx(V,{autoFocus:!0,required:!0,name:"spotifyId",minLength:22,maxLength:22,label:e.jsx(s,{message:"Spotify ID"}),description:e.jsx(s,{message:"Only public playlists can be imported."})})})}),e.jsxs(U,{children:[e.jsx(g,{onClick:()=>o(),children:e.jsx(s,{message:"Cancel"})}),e.jsx(g,{form:a,variant:"flat",color:"primary",type:"submit",disabled:r.isPending,children:e.jsx(s,{message:"Import"})})]})]})}const b=[{key:"public",label:i("Visibility"),description:i("Whether playlist is publicly viewable"),defaultOperator:p.eq,control:{type:m.Select,defaultValue:"01",options:[{key:"01",label:i("Private"),value:!1},{key:"02",label:i("Public"),value:!0}]}},{key:"collaborative",label:i("Collaborative"),description:i("Whether playlist is marked as collaborative"),defaultOperator:p.eq,control:{type:m.BooleanToggle,defaultValue:!0}},{key:"plays",label:i("Play count"),description:i("Number of times this playlist was played"),defaultOperator:p.gte,operators:h,control:{type:m.Input,defaultValue:100,inputType:"number"}},{key:"views",label:i("View count"),description:i("Number of times this playlist page was viewed"),defaultOperator:p.gte,operators:h,control:{type:m.Input,inputType:"number",defaultValue:100}},X({description:i("Date playlist was created")}),Z({description:i("Date playlist was last updated")})],be=[{key:"name",allowsSorting:!0,width:"flex-3 min-w-200",visibleInMode:"all",header:()=>e.jsx(s,{message:"Playlist"}),body:t=>e.jsx(j,{image:t.image,label:e.jsx(ae,{playlist:t})})},{key:"owner",header:()=>e.jsx(s,{message:"Owner"}),width:"flex-2",body:t=>{var a;return t.owner?e.jsx(j,{image:(a=t.owner)==null?void 0:a.image,label:e.jsx(Q,{user:t.owner}),description:t.owner.email}):null}},{key:"public",allowsSorting:!0,maxWidth:"max-w-100",header:()=>e.jsx(s,{message:"Public"}),body:t=>t.public&&e.jsx(x,{className:"text-muted"})},{key:"collaborative",allowsSorting:!0,maxWidth:"max-w-100",header:()=>e.jsx(s,{message:"Collaborative"}),body:t=>t.collaborative&&e.jsx(x,{className:"text-muted"})},{key:"views",maxWidth:"max-w-100",allowsSorting:!0,header:()=>e.jsx(s,{message:"Views"}),body:t=>t.views?e.jsx(de,{value:t.views}):null},{key:"updated_at",allowsSorting:!0,width:"w-100",header:()=>e.jsx(s,{message:"Last updated"}),body:t=>e.jsx(pe,{date:t.updated_at})},{key:"actions",header:()=>e.jsx(s,{message:"Actions"}),hideHeader:!0,align:"end",width:"w-42 flex-shrink-0",visibleInMode:"all",body:t=>e.jsxs(d,{type:"modal",onClose:a=>{a&&c()},children:[e.jsx(T,{size:"md",className:"text-muted",children:e.jsx(ce,{})}),e.jsx(te,{playlist:t})]})}];function kt(){const[t,a]=C.useState([]),{searchParams:o,sortDescriptor:r,mergeIntoSearchParams:l,setSearchQuery:u,isFiltering:F}=z(q),n=K(I.playlists.index({...o,with:"owner"})),k=e.jsxs(d,{type:"modal",children:[e.jsx(g,{variant:"flat",color:"danger",children:e.jsx(s,{message:"Delete"})}),e.jsx(De,{selectedIds:t,onDelete:()=>a([])})]});return e.jsxs(oe,{children:[e.jsx(G,{query:n}),e.jsx(W,{children:e.jsx(s,{message:"Playlists"})}),e.jsx(re,{title:e.jsx(s,{message:"Playlists"}),showSidebarToggleButton:!0}),e.jsxs(le,{children:[e.jsx(J,{searchValue:o.query,onSearchChange:u,actions:e.jsx(fe,{}),selectedItems:t,selectedActions:k,filters:b}),e.jsx(ie,{filters:b}),e.jsxs(ne,{children:[e.jsx(me,{columns:be,data:n.items,sortDescriptor:r,onSortChange:l,enableSelection:!0,selectedRows:t,onSelectionChange:a}),n.isEmpty&&e.jsx($,{isFiltering:F,image:ge,title:e.jsx(s,{message:"No playlists have been created yet"}),filteringTitle:e.jsx(s,{message:"No matching playlists"})}),e.jsx(Y,{query:n,onPageChange:y=>l({page:y}),onPerPageChange:y=>l({perPage:y})})]})]})]})}function fe(){const{spotify_is_setup:t}=H();return e.jsxs(C.Fragment,{children:[t&&e.jsxs(d,{type:"modal",onClose:a=>{a&&c()},children:[e.jsx(M,{label:e.jsx(s,{message:"Import by spotify ID"}),children:e.jsx(T,{variant:"outline",color:"primary",className:"flex-shrink-0",size:"sm",children:e.jsx(ue,{})})}),e.jsx(je,{})]}),e.jsxs(d,{type:"modal",onClose:a=>{a&&c()},children:[e.jsx(se,{children:e.jsx(s,{message:"Add new playlist"})}),e.jsx(ee,{})]})]})}function De({selectedIds:t,onDelete:a}){const{close:o}=S(),r=f({mutationFn:()=>v.delete(`playlists/${t.join(",")}`),onSuccess:async()=>{await c(),w(i("Playlists deleted")),a(),o()},onError:l=>D(l)});return e.jsx(ye,{isDanger:!0,isLoading:r.isPending,title:e.jsx(s,{message:"Delete playlists"}),body:e.jsx(s,{message:"Are you sure you want to delete selected playlists?",values:{count:t.length}}),confirm:e.jsx(s,{message:"Delete"}),onConfirm:()=>r.mutate()})}function c(){return P.invalidateQueries({queryKey:I.playlists.invalidateKey})}export{kt as Component};
