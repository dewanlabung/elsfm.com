import{j as e,T as s,W as x,v as y,J as a,z as N,G as D,H as S,I as A,aa as v,b as I,u as w,M as _,$ as T,a0 as V,a1 as E,a2 as L,as as B,V as H,t as b,r as F,at as k,S as O,ab as q,D as P,ae as M,a8 as z}from"./main-CUJEGI8U.js";import{S as Q}from"./small-artist-image-BqXmK0zy.js";import{A as R}from"./artist-link-XkkvBaYk.js";import{F as W}from"./formatted-date-DzIPJwiH.js";import{F as g}from"./formatted-number-gsF1qEbc.js";import{B as G}from"./BarChart-BpaNOmqn.js";import{E as $}from"./Edit-BRVJ8AkN.js";import{V as K}from"./VisibilityOff-CM8YBNPw.js";import{F as m,d,A as h,u as J,a as U,G as X,D as Y,b as Z,c as ee}from"./use-datatable-query-D9uebfzx.js";import{c as te,u as se}from"./timestamp-filters-DydeeDDl.js";import{D as ae}from"./dialog-footer-jZcc-BBM.js";import{A as re}from"./artist-C2fP4kQS.js";import{D as ie}from"./paginated-resources-BDxg6DLi.js";import{F as j}from"./switch-4KDjemPX.js";import{D as oe}from"./data-table-add-item-button-_qDHIKil.js";import{D as le}from"./datatable-filters-DFYg3QEK.js";import{a as ne,D as me,b as de,c as pe}from"./datatable-page-with-header-layout-C4e5sJMc.js";import{T as ue}from"./table-CgoYghfp.js";import{P as ce}from"./Publish-wob_XvAQ.js";import{C as ge}from"./confirmation-dialog-DVMbD2S1.js";import{G as xe}from"./music-Bh2SQVZ2.js";import"./Mic-DAPkQZuC.js";import"./use-date-formatter-m8TmZzOM.js";import"./DateFormatter-Dix9bfnP.js";import"./FilterAlt-Cw-mRuQp.js";import"./form-normalized-model-chip-field-R33Z1aXc.js";import"./use-normalized-models-ClA2DWxP.js";import"./form-chip-field-ehb7ckkp.js";import"./input-DAWJLQiY.js";import"./chip-list-D0uDB84E.js";import"./accordion-BALGWyw-.js";import"./checkbox-suk8vW77.js";import"./CheckBoxOutlineBlank-BgWeDdny.js";import"./ArrowRightAlt-iO8zeT1U.js";import"./DateRange-Bhvye4F9.js";import"./use-base-date-picker-state-DaWG2IMs.js";import"./KeyboardArrowRight-CjTKdvdU.js";import"./use-date-range-picker-state-CSWp3d1-.js";import"./list-C96mDrnJ.js";import"./is-tablet-media-query-DhMPnSWn.js";import"./use-current-date-time-BhbL04rR.js";import"./select-Z9R0wV6S.js";import"./combobox-end-adornment-B0xReOuL.js";import"./normalized-model-field-8T9JWy8W.js";import"./skeleton-BmWW5Jc-.js";import"./Add-B3RL66ee.js";import"./dashboard-layout-context-DeTNv3yG.js";import"./ArrowDownward-BHYKFIfy.js";import"./useInteractOutside-BFJZ3Z5N.js";import"./useEffectEvent-pADbdn7r.js";import"./is-ctrl-or-shift-pressed-Bx-mqgCW.js";import"./use-pointer-events-DcvSqvAc.js";import"./useGlobalListeners-BeXr-yG1.js";const ye=[{key:"name",allowsSorting:!0,header:()=>e.jsx(s,{message:"Artist"}),width:"flex-3",visibleInMode:"all",body:t=>e.jsxs("div",{className:"flex w-max items-center gap-12",children:[e.jsx(Q,{artist:t,className:"flex-shrink-0",size:"w-34 h-34 rounded"}),e.jsx(R,{artist:t,target:"_blank"}),t.disabled?e.jsx(K,{size:"sm",className:"text-muted"}):null]})},{key:"albums_count",allowsSorting:!0,header:()=>e.jsx(s,{message:"Album count"}),body:t=>t.albums_count?e.jsx(g,{value:t.albums_count}):null},{key:"plays",allowsSorting:!0,header:()=>e.jsx(s,{message:"Total plays"}),body:t=>t.plays?e.jsx(g,{value:t.plays}):null},{key:"views",allowsSorting:!0,header:()=>e.jsx(s,{message:"Page views"}),body:t=>t.views?e.jsx(g,{value:t.views}):null},{key:"updated_at",allowsSorting:!0,maxWidth:"max-w-100",header:()=>e.jsx(s,{message:"Last updated"}),body:t=>t.updated_at?e.jsx(W,{date:t.updated_at}):""},{key:"actions",header:()=>e.jsx(s,{message:"Actions"}),hideHeader:!0,visibleInMode:"all",align:"end",width:"w-84 flex-shrink-0",body:t=>e.jsxs("div",{className:"text-muted",children:[e.jsx(x,{size:"md",elementType:y,to:`${t.id}/insights`,children:e.jsx(G,{})}),e.jsx(x,{size:"md",elementType:y,to:`${t.id}/edit`,children:e.jsx($,{})})]})}],f=[{key:"verified",label:a("Status"),description:a("Whether artist is verified"),defaultOperator:d.eq,control:{type:m.Select,defaultValue:"01",options:[{key:"01",label:a("Verified"),value:!0},{key:"02",label:a("Not verified"),value:!1}]}},{key:"disabled",label:a("Visibility"),description:a("Whether artist is hidden on the site"),defaultOperator:d.eq,control:{type:m.Select,defaultValue:"01",options:[{key:"01",label:a("Hidden"),value:!0},{key:"02",label:a("Visible"),value:!1}]}},{key:"plays",label:a("Plays count"),description:a("Number of times artist tracks have been played"),defaultOperator:d.gte,operators:h,control:{type:m.Input,inputType:"number",defaultValue:100}},{key:"views",label:a("Views count"),description:a("Number of times artist page have been viewed"),defaultOperator:d.gte,operators:h,control:{type:m.Input,inputType:"number",defaultValue:100}},te({description:a("Date artist was created")}),se({description:a("Date artist was last updated")})];function be(){const{trans:t}=N();return D({mutationFn:r=>he(r),onSuccess:()=>{A(t(a("Artist imported"))),v.invalidateQueries({queryKey:ie("artists")})},onError:r=>S(r)})}function he(t){return I.post("import-media/single-item",{modelType:re,spotifyId:t.spotifyId,importSimilarArtists:t.importSimilarArtists,importAlbums:t.importAlbums}).then(r=>r.data)}function je(){const t=w(),r=_({defaultValues:{importAlbums:!0,importSimilarArtists:!0}}),{formId:i,close:l}=T(),o=be();return e.jsxs(V,{children:[e.jsx(E,{children:e.jsx(s,{message:"Import artist"})}),e.jsx(L,{children:e.jsxs(B,{id:i,form:r,onSubmit:p=>{o.mutate(p,{onSuccess:u=>{l(u.artist)}})},children:[e.jsx(H,{autoFocus:!0,required:!0,name:"spotifyId",minLength:22,maxLength:22,label:e.jsx(s,{message:"Spotify ID"}),className:"mb-24"}),e.jsx(j,{name:"importAlbums",className:"mb-24",children:e.jsx(s,{message:"Import albums"})}),t.spotify_use_deprecated_api&&e.jsx(j,{name:"importSimilarArtists",children:e.jsx(s,{message:"Import similar artists"})})]})}),e.jsxs(ae,{children:[e.jsx(b,{onClick:()=>l(),children:e.jsx(s,{message:"Cancel"})}),e.jsx(b,{form:i,variant:"flat",color:"primary",type:"submit",disabled:o.isPending,children:e.jsx(s,{message:"Import"})})]})]})}function Dt(){const[t,r]=F.useState([]),{searchParams:i,sortDescriptor:l,mergeIntoSearchParams:o,setSearchQuery:p,isFiltering:u}=J(q),n=U(k.artists.index(i)),C=e.jsxs(P,{type:"modal",children:[e.jsx(b,{variant:"flat",color:"danger",children:e.jsx(s,{message:"Delete"})}),e.jsx(De,{selectedIds:t,onDelete:()=>r([])})]});return e.jsxs(ne,{children:[e.jsx(X,{query:n}),e.jsx(O,{children:e.jsx(s,{message:"Artists"})}),e.jsx(me,{title:e.jsx(s,{message:"Artists"}),showSidebarToggleButton:!0}),e.jsxs(de,{children:[e.jsx(Y,{searchValue:i.query,onSearchChange:p,actions:e.jsx(fe,{}),selectedItems:t,selectedActions:C,filters:f}),e.jsx(le,{filters:f}),e.jsxs(pe,{children:[e.jsx(ue,{columns:ye,data:n.items,sortDescriptor:l,onSortChange:o,enableSelection:!0,selectedRows:t,onSelectionChange:r}),n.isEmpty&&e.jsx(Z,{isFiltering:u,image:xe,title:e.jsx(s,{message:"No artists have been created yet"}),filteringTitle:e.jsx(s,{message:"No matching artists"})}),e.jsx(ee,{query:n,onPageChange:c=>o({page:c}),onPerPageChange:c=>o({perPage:c})})]})]})]})}function fe(){const{spotify_is_setup:t}=w(),r=M();return e.jsxs(F.Fragment,{children:[t&&e.jsxs(P,{type:"modal",onClose:i=>{i&&r(`/admin/artists/${i.id}/edit`)},children:[e.jsx(z,{label:e.jsx(s,{message:"Import by spotify ID"}),children:e.jsx(x,{variant:"outline",color:"primary",className:"flex-shrink-0",size:"sm",children:e.jsx(ce,{})})}),e.jsx(je,{})]}),e.jsx(oe,{elementType:y,to:"new",children:e.jsx(s,{message:"Add new artist"})})]})}function De({selectedIds:t,onDelete:r}){const{close:i}=T(),l=D({mutationFn:()=>I.delete(`artists/${t.join(",")}`),onSuccess:async()=>{await v.invalidateQueries({queryKey:k.artists.invalidateKey}),A(a("Artists deleted")),r(),i()},onError:o=>S(o)});return e.jsx(ge,{isDanger:!0,isLoading:l.isPending,title:e.jsx(s,{message:"Delete artists"}),body:e.jsx(s,{message:"Are you sure you want to delete selected artists?",values:{count:t.length}}),confirm:e.jsx(s,{message:"Delete"}),onConfirm:()=>l.mutate()})}export{Dt as Component};
