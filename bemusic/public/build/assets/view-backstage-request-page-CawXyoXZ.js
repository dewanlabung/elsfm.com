import{aJ as j,G as p,H as g,I as h,J as m,aa as f,b as v,z as D,$ as q,M as N,j as e,a0 as R,a1 as A,T as a,a2 as B,as as I,V as T,t as n,r as x,D as c,U as F,aK as S,aL as z}from"./main-CUJEGI8U.js";import{B as b}from"./backstage-request-type-CLKnoTCa.js";import{D as y}from"./paginated-resources-BDxg6DLi.js";import{D as _}from"./dialog-footer-jZcc-BBM.js";import{F as E}from"./switch-4KDjemPX.js";import{D as V}from"./datatable-page-with-header-layout-C4e5sJMc.js";import{B as $,a as k}from"./breadcrumb-FXqyksUv.js";import{C as P}from"./confirmation-dialog-DVMbD2S1.js";import{S as L}from"./small-artist-image-BqXmK0zy.js";import{A as H}from"./artist-link-XkkvBaYk.js";import{u as K}from"./use-backstage-request-21abtmK3.js";import{P as Q}from"./page-status-Cu3QYyqq.js";import{L as J}from"./external-link-jlnQ3iTs.js";import{D as M}from"./DocumentScanner-CjU3RFtx.js";import{I as U}from"./image-zoom-dialog-DLwmxXxG.js";import{p as G}from"./pretty-bytes-bO14ePu9.js";import"./dashboard-layout-context-DeTNv3yG.js";import"./useEffectEvent-pADbdn7r.js";import"./ChevronRight-BB6TpByg.js";import"./MoreHoriz-RUUnngeG.js";import"./Mic-DAPkQZuC.js";import"./KeyboardArrowRight-CjTKdvdU.js";function Z(){const s=j();return p({mutationFn:({requestId:t})=>O(t),onSuccess:()=>{h(m("Request deleted")),s("/admin/backstage-requests"),f.invalidateQueries({queryKey:y("backstage-request")})},onError:t=>g(t)})}function O(s){return v.delete(`backstage-request/${s}`).then(t=>t.data)}function W(){const s=j();return p({mutationFn:t=>X(t),onSuccess:()=>{h(m("Request approved")),s("/admin/backstage-requests"),f.invalidateQueries({queryKey:y("backstage-request")})},onError:t=>g(t)})}function X({requestId:s,...t}){return v.post(`backstage-request/${s}/approve`,t).then(r=>r.data)}function Y({request:s}){const{trans:t}=D(),{close:r,formId:i}=q(),d=N(),l=W();return e.jsxs(R,{size:"lg",children:[e.jsx(A,{children:e.jsx(a,{message:"Approve request"})}),e.jsx(B,{children:e.jsxs(I,{form:d,id:i,onSubmit:u=>{l.mutate({...u,requestId:s.id})},children:[e.jsx("div",{className:"mb-14",children:e.jsx(a,{message:"Are you sure you want to approve this request?"})}),e.jsx("div",{className:"font-bold",children:e.jsx(a,{message:"This will create a new artist profile and assign it to ':user', as well as give them artist role on the site.",values:{user:s.user.name}})}),e.jsx(E,{name:"markArtistAsVerified",className:"my-24",children:e.jsx(a,{message:"Also mark this artist as verified"})}),e.jsx(T,{label:e.jsx(a,{message:"Notes (optional)"}),name:"notes",placeholder:t(m("Add any extra notes that should be sent to use via notification email")),inputElementType:"textarea",rows:6})]})}),e.jsxs(_,{children:[e.jsx(n,{onClick:()=>r(),children:e.jsx(a,{message:"Cancel"})}),e.jsx(n,{variant:"flat",color:"primary",type:"submit",form:i,disabled:l.isPending,children:e.jsx(a,{message:"Approve"})})]})]})}function ee(){const s=j();return p({mutationFn:t=>se(t),onSuccess:()=>{h(m("Request denied")),s("/admin/backstage-requests"),f.invalidateQueries({queryKey:y("backstage-request")})},onError:t=>g(t)})}function se({requestId:s,...t}){return v.post(`backstage-request/${s}/deny`,t).then(r=>r.data)}function ae({request:s}){const{trans:t}=D(),{close:r,formId:i}=q(),d=N(),l=ee();return e.jsxs(R,{size:"lg",children:[e.jsx(A,{children:e.jsx(a,{message:"Deny request"})}),e.jsx(B,{children:e.jsxs(I,{form:d,id:i,onSubmit:u=>{l.mutate({...u,requestId:s.id})},children:[e.jsx("div",{className:"mb-14",children:e.jsx(a,{message:"Are you sure you want to deny this request?"})}),e.jsx("div",{className:"mb-24 font-bold",children:e.jsx(a,{message:"This will mark request as denied and notify ':user'.",values:{user:s.user.name}})}),e.jsx(T,{label:e.jsx(a,{message:"Notes (optional)"}),name:"notes",placeholder:t(m("Add any extra notes that should be sent to use via notification email")),inputElementType:"textarea",rows:6})]})}),e.jsxs(_,{children:[e.jsx(n,{onClick:()=>r(),children:e.jsx(a,{message:"Cancel"})}),e.jsx(n,{variant:"flat",color:"danger",type:"submit",form:i,disabled:l.isPending,children:e.jsx(a,{message:"Deny"})})]})]})}function te({request:s}){return e.jsx(V,{title:e.jsxs($,{children:[e.jsx(k,{to:"/admin/backstage-requests",children:e.jsx(a,{message:"Backstage requests"})}),e.jsx(k,{children:e.jsx(a,{message:"View"})})]}),rightContent:e.jsxs(x.Fragment,{children:[s.status==="pending"&&e.jsxs(x.Fragment,{children:[e.jsxs(c,{type:"modal",children:[e.jsx(n,{variant:"flat",color:"primary",children:e.jsx(a,{message:"Approve"})}),e.jsx(Y,{request:s})]}),e.jsxs(c,{type:"modal",children:[e.jsx(n,{variant:"outline",children:e.jsx(a,{message:"Deny"})}),e.jsx(ae,{request:s})]})]}),e.jsx(re,{request:s})]})})}function re({request:s}){const t=Z();return e.jsxs(c,{type:"modal",onClose:r=>{r&&t.mutate({requestId:s.id})},children:[e.jsx(n,{disabled:t.isPending,variant:"outline",children:e.jsx(a,{message:"Delete"})}),e.jsx(P,{isDanger:!0,title:e.jsx(a,{message:"Delete request"}),body:e.jsx(a,{message:"Are you sure you want to delete this request?"}),confirm:e.jsx(a,{message:"Delete"})})]})}function Be(){const s=K();return s.data?e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx(te,{request:s.data.request}),e.jsxs("div",{className:"container mx-auto flex-auto overflow-y-auto p-24",children:[e.jsx(ie,{request:s.data.request}),e.jsx(ne,{request:s.data.request})]})]}):e.jsx(Q,{query:s})}function ie({request:s}){var t;return e.jsxs("div",{className:"mt-60",children:[e.jsx("div",{className:"mb-14 mt-24 text-2xl",children:e.jsx(a,{message:"Request details"})}),e.jsxs("div",{children:[e.jsx(o,{name:e.jsx(a,{message:"Image"}),value:s.data.image?e.jsx("img",{src:s.data.image||((t=s.artist)==null?void 0:t.image_small),className:"max-h-100 rounded",alt:""}):null}),e.jsx(o,{name:e.jsx(a,{message:"Type"}),value:e.jsx(b,{type:s.type})}),e.jsx(o,{name:e.jsx(a,{message:"Requester"}),value:e.jsxs("div",{className:"flex items-center gap-8",children:[e.jsx(F,{user:s.user}),s.user.name]})}),s.artist&&e.jsx(o,{name:e.jsx(a,{message:"Artist"}),value:e.jsxs("div",{className:"flex w-max items-center gap-12",children:[e.jsx(L,{artist:s.artist,className:"flex-shrink-0 rounded",size:"w-32 h-32"}),e.jsx(H,{artist:s.artist})]})}),e.jsx(o,{name:e.jsx(a,{message:"Requested artist name"}),value:e.jsx(b,{type:s.artist_name})}),e.jsx(o,{name:e.jsx(a,{message:"Requested role"}),value:s.data.role?e.jsx(a,{message:s.data.role}):void 0}),e.jsx(o,{name:e.jsx(a,{message:"Name"}),value:s.data.name}),e.jsx(o,{name:e.jsx(a,{message:"Company"}),value:s.data.company})]})]})}function o({name:s,value:t}){return e.jsxs("div",{className:"items-center gap-24 border-b py-12 text-sm md:flex md:py-18",children:[e.jsx("div",{className:"mb-8 min-w-200 md:mb-0",children:s}),e.jsx("div",{children:t})]})}function ne({request:s}){return e.jsxs("div",{className:"mt-60",children:[e.jsx("div",{className:"mb-14 mt-24 text-2xl",children:e.jsx(a,{message:"Attached verification"})}),e.jsxs("div",{children:[s.data.passport_scan_entry&&e.jsx(C,{icon:e.jsx(M,{}),title:e.jsx(a,{message:"Passport scan"}),description:`${s.data.passport_scan_entry.name} (${G(s.data.passport_scan_entry.file_size)})`,action:e.jsxs(c,{type:"modal",children:[e.jsx(n,{variant:"outline",color:"primary",size:"xs",children:e.jsx(a,{message:"View"})}),e.jsx(U,{image:s.data.passport_scan_entry.url})]})}),e.jsx(w,{request:s,service:"twitter"}),e.jsx(w,{request:s,service:"facebook"})]})]})}function w({service:s,request:t}){const r=t.user.social_profiles.find(i=>i.service_name===s);return r?e.jsx(C,{icon:s==="twitter"?e.jsx(S,{className:"text-twitter"}):e.jsx(z,{className:"text-facebook"}),title:e.jsx("span",{className:"capitalize",children:e.jsx(a,{message:":service account",values:{service:s}})}),action:e.jsx(n,{elementType:"a",className:J,variant:"outline",color:"primary",size:"xs",href:s==="twitter"?`https://twitter.com/${r.username}`:`https://facebook.com/${r.username}`,target:"_blank",children:e.jsx(a,{message:"View"})}),description:r.username}):null}function C({icon:s,title:t,description:r,action:i}){return e.jsxs("div",{className:"mb-8 flex items-center gap-8 rounded border px-14 py-8",children:[e.jsx("div",{className:"flex-shrink-0 text-muted",children:x.cloneElement(s,{size:"lg"})}),e.jsxs("div",{className:"mr-auto overflow-hidden whitespace-nowrap",children:[e.jsx("div",{className:"overflow-hidden overflow-ellipsis text-xs text-muted",children:t}),e.jsx("div",{className:"overflow-hidden overflow-ellipsis text-sm",children:r})]}),i]})}export{Be as Component};
