import{r as j,j as e,t as p,T as d,ad as F,d as h,D as I,M as w,$ as T,a0 as z,a1 as B,a2 as P,as as R,c1 as S,z as N,c8 as V,W as L,an as A,J as y}from"./main-CUJEGI8U.js";import{F as u,N as M,e as $,I as O,C as E,S as K,f as _,g as H,d as J}from"./use-datatable-query-D9uebfzx.js";import{u as U}from"./normalized-model-field-8T9JWy8W.js";import{D as C,F as W}from"./use-date-range-picker-state-CSWp3d1-.js";import{F as q}from"./formatted-number-gsF1qEbc.js";import{S as b}from"./skeleton-BmWW5Jc-.js";import{D as G}from"./dialog-footer-jZcc-BBM.js";const k=j.forwardRef((t,n)=>{const{isInactive:a,filter:l,...r}=t;return a?e.jsx(Q,{filter:l,...r,ref:n}):e.jsx(X,{filter:l,...r,ref:n})}),Q=j.forwardRef(({filter:t,...n},a)=>e.jsx(p,{variant:"outline",size:"xs",radius:"rounded-md",border:"border",ref:a,endIcon:e.jsx(F,{}),...n,children:e.jsx(d,{...t.label})})),X=j.forwardRef(({filter:t,children:n,...a},l)=>{const r=t.control.type===u.BooleanToggle;return e.jsxs(p,{variant:"outline",size:"xs",color:"primary",radius:"rounded-r-md",border:"border-y border-r",endIcon:!r&&e.jsx(F,{}),ref:l,...a,children:[e.jsx("span",{className:h(!r&&"mr-8 border-r border-r-primary-light pr-8"),children:e.jsx(d,{...t.label})}),n]})});function f(t){const{onValueChange:n,isInactive:a,filter:l,label:r}=t;return e.jsxs(I,{offset:10,type:"popover",onClose:s=>{s!==void 0&&n(s)},children:[e.jsx(k,{isInactive:a,filter:l,children:r}),e.jsx(Y,{...t})]})}function Y({filter:t,panel:n,value:a,operator:l}){const r=w({defaultValues:{[t.key]:{value:a,operator:l}}}),{close:s,formId:i}=T();return e.jsxs(z,{size:"xs",children:[e.jsx(B,{children:e.jsx(d,{...t.label})}),e.jsx(P,{className:"max-h-288",children:e.jsxs(R,{form:r,id:i,onSubmit:o=>{s(o[t.key])},children:[t.description&&e.jsx("div",{className:"mb-14 text-xs text-muted",children:e.jsx(d,{...t.description})}),n]})}),e.jsx(G,{children:e.jsx(p,{form:i,type:"submit",variant:"flat",color:"primary",size:"xs",children:e.jsx(d,{message:"Apply"})})})]})}function Z(t){switch(t.filter.control.type){case u.DateRangePicker:return e.jsx(ee,{...t});case u.BooleanToggle:return e.jsx(te,{...t});case u.Select:return e.jsx(ne,{...t});case u.ChipField:return e.jsx(re,{...t});case u.Input:return e.jsx(le,{...t});case u.SelectModel:return e.jsx(oe,{...t});case u.Custom:const n=t.filter.control.listItem;return e.jsx(n,{...t});default:return null}}function ee(t){const{value:n,filter:a}=t;let l;return n.preset!==void 0?l=e.jsx(d,{...C[n.preset].label}):l=e.jsx(W,{start:new Date(n.start),end:new Date(n.end),options:{dateStyle:"medium"}}),e.jsx(f,{...t,label:l,panel:e.jsx(_,{filter:a})})}function te({filter:t,isInactive:n,onValueChange:a}){return e.jsx(k,{onClick:()=>{a({value:t.control.defaultValue})},filter:t,isInactive:n})}function ne(t){const{filter:n,value:a}=t,l=n.control.options.find(r=>r.key===a);return e.jsx(f,{...t,label:l?typeof l.label=="string"?l.label:e.jsx(d,{...l.label}):null,panel:e.jsx(K,{filter:n})})}function re(t){const n=t.filter.control.autocompleteEndpoint?t.value.map(a=>a.name).join(", "):e.jsx(ae,{...t});return e.jsx(f,{...t,label:n,panel:e.jsx(E,{filter:t.filter})})}function ae(t){const{trans:n}=N(),{filter:a,value:l}=t,r=l.map(m=>{var c;return(c=a.control.options)==null?void 0:c.find(x=>x.key===m)}),s=3,i=l.length-s,o=e.jsx(j.Fragment,{children:r.filter(Boolean).slice(0,s).map((m,c)=>{let x="";return c!==0&&(x+=", "),x+=typeof m.label=="string"?m.label:n(m.label),x})});return i>0?e.jsx(d,{message:":names + :count more",values:{names:o,count:i}}):o}function le(t){const{filter:n,value:a,operator:l}=t,r=l?e.jsx(d,{...$[l]}):null,s=n.control.inputType==="number"?e.jsx(q,{value:a}):a;return e.jsx(f,{...t,label:e.jsxs(j.Fragment,{children:[r," ",s]}),panel:e.jsx(O,{filter:n})})}function oe(t){const{value:n,filter:a}=t,{isLoading:l,data:r}=U(a.control.endpoint?`${a.control.endpoint}/${n}`:`normalized-models/${a.control.model}/${n}`,void 0,{enabled:!!n}),s=e.jsxs(j.Fragment,{children:[e.jsx(b,{variant:"avatar",size:"w-18 h-18 mr-6"}),e.jsx(b,{variant:"rect",size:"w-50"})]}),i=e.jsxs(j.Fragment,{children:[e.jsx(S,{size:"xs",src:r==null?void 0:r.model.image,label:r==null?void 0:r.model.name,className:"mr-6"}),r==null?void 0:r.model.name]}),o=l||!r?s:i;return e.jsx(f,{...t,label:o,panel:e.jsx(M,{filter:a})})}function je({filters:t,pinnedFilters:n,className:a,wrap:l}){const{decodedFilters:r,remove:s,replaceAll:i}=V(t,n);return r.length?e.jsx("div",{className:h("flex flex-shrink-0 items-center gap-6",a,l?"flex-wrap":"overflow-x-auto"),children:r.map((o,m)=>{const c=t.find(g=>g.key===o.key);if(!c)return null;const x=g=>{const v=[...r];v.splice(m,1,{key:c.key,value:g.value,isInactive:!1,operator:g.operator||c.defaultOperator}),i(v)};return e.jsxs("div",{className:"flex items-center",children:[!o.isInactive&&e.jsx(L,{variant:"outline",color:"primary",size:"xs",radius:"rounded-l-md",onClick:()=>{s(o.key)},children:e.jsx(A,{})}),e.jsx(Z,{filter:c,isInactive:o.isInactive,value:o.valueKey!=null?o.valueKey:o.value,operator:o.operator,onValueChange:x})]},o.key)})}):null}function D(t){var n;return{...t,defaultOperator:J.between,control:{type:u.DateRangePicker,defaultValue:((n=t.control)==null?void 0:n.defaultValue)||H(C[3].getRangeValue())}}}function fe(t){return D({key:"created_at",label:y("Date created"),...t})}function ge(t){return D({key:"updated_at",label:y("Last updated"),...t})}export{je as F,fe as c,D as t,ge as u};
