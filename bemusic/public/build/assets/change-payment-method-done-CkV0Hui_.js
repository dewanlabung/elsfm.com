import{u as f,ae as h,X as p,r as i,aa as y,cw as _,j as S,J as t,b}from"./main-CUJEGI8U.js";import{l as C}from"./index-U9JJOqTM.js";import{B as q}from"./billing-redirect-message-B2ni2sMt.js";import"./TaskAlt-D7tFnO3X.js";import"./skeleton-BmWW5Jc-.js";const m="/billing";function R(){const{billing:e}=f(),g=h(),[l]=p(),r=l.get("setup_intent_client_secret"),[d,o]=i.useState(),n=i.useRef(!1);return i.useEffect(()=>{n.current||!r||(C(e==null?void 0:e.stripe_public_key).then(c=>{if(!c){o(u());return}c.retrieveSetupIntent(r).then(({setupIntent:s})=>{(s==null?void 0:s.status)==="succeeded"&&v(s.payment_method).then(()=>{y.invalidateQueries({queryKey:_.user().queryKey})}),o(u(s==null?void 0:s.status))})}),n.current=!0)},[e==null?void 0:e.stripe_public_key,r]),r?S.jsx(q,{config:d}):(g(m),null)}function u(e){switch(e){case"succeeded":return{...a,message:t("Payment method changed successfully!"),status:"success"};case"processing":return{...a,message:t("Your request is processing. We'll update you when your payment method is confirmed."),status:"success"};case"requires_payment_method":return{...a,message:t("Payment method confirmation failed. Please try another payment method."),status:"error"};default:return{...a,message:t("Something went wrong"),status:"error"}}}const a={link:m,buttonLabel:t("Go back")};function v(e){return b.post("billing/stripe/change-default-payment-method",{payment_method_id:e})}export{R as Component};
