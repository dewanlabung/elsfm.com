import{r as p,P as S,j as e,a4 as G,W as C,a5 as J,Q as y,T as o,D as N,I as Q,J as j,M as A,$,a0 as L,a1 as R,a2 as E,as as q,t as D,V as Y,c4 as Z,az as X,z as ee,ar as se,ao as te,a7 as ae,cZ as ie,K as re,A as ne,ai as oe,aj as le,o as H,p as O,bY as U,d as V,a6 as ce,aF as me,_ as de,ay as ue}from"./main-CUJEGI8U.js";import{a as he}from"./admin-config-DTFkVWJm.js";import{u as v}from"./settings-layout-KPbHCtKd.js";import{S as fe,a as k}from"./settings-section-button-BOceg79h.js";import{u as _}from"./use-admin-settings-CWPhg6hD.js";import{F as w}from"./switch-4KDjemPX.js";import{D as xe}from"./Delete-BwrOLlzK.js";import{M as ge}from"./MoreVert-BiULonS7.js";import{T as je,R as pe}from"./Tune-g0H3xJpf.js";import{C as ye}from"./confirmation-dialog-DVMbD2S1.js";import{D as W}from"./dialog-footer-jZcc-BBM.js";import{A as be}from"./Add-B3RL66ee.js";import{S as z,F as Se}from"./select-Z9R0wV6S.js";import{C as ve}from"./color-icon-Xc96SOHB.js";import{C as ke}from"./color-picker-dialog-DMELDOWr.js";import{u as we}from"./use-filter-cTKMA7-l.js";import{K as Ce}from"./KeyboardArrowRight-CjTKdvdU.js";import{S as M}from"./skeleton-BmWW5Jc-.js";import{A as Ne,a as B}from"./accordion-BALGWyw-.js";import"./Album-pwm22nnR.js";import"./Comment-vFUyF-gf.js";import"./FileUpload-CTBOdaGq.js";import"./Mic-DAPkQZuC.js";import"./PlaylistPlay-DcgxbGJx.js";import"./QueueMusic-CiX-EN5z.js";import"./Sell-D56iqjs7.js";import"./settings-links-6v3CjZ6H.js";import"./external-link-jlnQ3iTs.js";import"./middleware-BLXTWOs6.js";import"./use-admin-settings-page-nav-config-C00ols9x.js";import"./datatable-page-with-header-layout-C4e5sJMc.js";import"./dashboard-layout-context-DeTNv3yG.js";import"./file-upload-provider-DWaB2xE4.js";import"./uploaded-file-ksxfN_l-.js";import"./extension-from-filename-O0XMuZye.js";import"./pretty-bytes-bO14ePu9.js";import"./traditional-BcYcLesO.js";import"./OpenInFull-D-qHNzAi.js";import"./useSuspenseQuery-13TuSADp.js";import"./combobox-end-adornment-B0xReOuL.js";function De({selectedThemeId:s,initialThemeId:a,onSelectedThemeChange:t}){const r=v(u=>u.preview),[l,m]=p.useState(!1),[i,h]=p.useState(!1),{setValue:c,getValues:d}=S(),{data:{defaults:f}}=_(),n=()=>{if(d("themes").length<=1){Q.danger(j("At least one theme is required"));return}if(s){c("themes",d("themes").filter(g=>g.id!==s),{shouldDirty:!0});const u=d("themes").find(g=>g.id===a);a===s?window.location.reload():t(u?a:d("themes")[0].id)}},x=()=>{const g=`themes.${d("themes").findIndex(F=>F.id===s)}`,b=d(`${g}.is_dark`)?f.themes.dark:f.themes.light;Object.entries(b).forEach(([F,K])=>{r.setThemeValue(F,K)}),r.setThemeFont(null),c(`${g}.values`,b,{shouldDirty:!0}),c(`${g}.font`,void 0,{shouldDirty:!0})};return e.jsxs(p.Fragment,{children:[e.jsxs(G,{children:[e.jsx(C,{variant:"outline",size:"sm",children:e.jsx(ge,{})}),e.jsxs(J,{children:[e.jsx(y,{value:"settings",startIcon:e.jsx(je,{}),onSelected:()=>h(!0),children:e.jsx(o,{message:"Settings"})}),e.jsx(y,{value:"reset",startIcon:e.jsx(pe,{}),onSelected:()=>x(),children:e.jsx(o,{message:"Reset to default"})}),e.jsx(y,{value:"delete",startIcon:e.jsx(xe,{}),onSelected:()=>m(!0),children:e.jsx(o,{message:"Delete"})})]})]}),e.jsx(N,{type:"modal",isOpen:l,onClose:u=>{u&&n(),m(!1)},children:e.jsx(ye,{isDanger:!0,title:e.jsx(o,{message:"Delete theme"}),body:e.jsx(o,{message:"Are you sure you want to delete this theme?"}),confirm:e.jsx(o,{message:"Delete"})})}),e.jsx(N,{type:"modal",isOpen:i,onClose:()=>h(!1),children:e.jsx(Fe,{theme:d("themes").find(u=>u.id===s)})})]})}function Fe({theme:s}){const a=S(),t=A({defaultValues:s}),{close:r,formId:l}=$();p.useEffect(()=>{const i=t.watch((h,{name:c})=>{c==="default_light"&&h.default_light&&t.setValue("default_dark",!1),c==="default_dark"&&h.default_dark&&t.setValue("default_light",!1)});return()=>i.unsubscribe()},[t]);const m=i=>{a.getValues("themes").forEach((h,c)=>{if(h.id===i.id){a.setValue(`themes.${c}`,i,{shouldDirty:!0});return}if(i.default_light){a.setValue(`themes.${c}`,{...h,default_light:!1},{shouldDirty:!0});return}if(i.default_dark){a.setValue(`themes.${c}`,{...h,default_dark:!1},{shouldDirty:!0});return}})};return e.jsxs(L,{children:[e.jsx(R,{children:e.jsx(o,{message:"Update settings"})}),e.jsx(E,{children:e.jsx(q,{form:t,id:l,onSubmit:i=>{m(i),r()},children:e.jsx(P,{})})}),e.jsxs(W,{children:[e.jsx(D,{onClick:()=>{r()},children:e.jsx(o,{message:"Cancel"})}),e.jsx(D,{variant:"flat",color:"primary",type:"submit",form:l,disabled:!t.formState.isDirty,children:e.jsx(o,{message:"Save"})})]})]})}function P(){return e.jsxs(p.Fragment,{children:[e.jsx(Y,{name:"name",label:e.jsx(o,{message:"Name"}),className:"mb-24",autoFocus:!0,required:!0}),e.jsx(w,{name:"is_dark",className:"mb-20 border-b pb-20",description:e.jsx(o,{message:"Whether this theme has light text on dark background."}),children:e.jsx(o,{message:"Dark theme"})}),e.jsx(w,{name:"default_light",className:"mb-24",description:e.jsx(o,{message:"When light mode is selected, this theme will be used."}),children:e.jsx(o,{message:"Default for light mode"})}),e.jsx(w,{name:"default_dark",description:e.jsx(o,{message:"When dark mode is selected, this theme will be used."}),children:e.jsx(o,{message:"Default for dark mode"})})]})}function Ie(s=1,a=1e4){const t=new Uint32Array(1);window.crypto.getRandomValues(t);const r=t[0]/4294967296;return s=Math.ceil(s),a=Math.floor(a),Math.floor(r*(a-s+1))+s}function Te({type:s="site",onCreated:a}){return e.jsxs(N,{type:"modal",onClose:t=>{t!=null&&(a==null||a(t))},children:[e.jsx(C,{variant:"outline",shadow:"shadow",size:"sm",className:"ml-auto",children:e.jsx(be,{})}),e.jsx(Ve,{type:s})]})}function Ve({type:s}){const{formId:a,close:t}=$(),{data:{defaults:r}}=_(),l=S(),m=A({defaultValues:{default_dark:!1,default_light:!1,is_dark:!1}}),i=h=>{const c=h.is_dark?r.themes.dark:r.themes.light,d=l.getValues("themes"),f=Ie(100,1e3);l.setValue("themes",[...d,{...h,id:f,type:s,values:c}],{shouldDirty:!0}),t(f)};return e.jsxs(L,{children:[e.jsx(R,{children:e.jsx(o,{message:"New theme"})}),e.jsx(E,{children:e.jsx(q,{id:a,form:m,onSubmit:i,children:e.jsx(P,{})})}),e.jsxs(W,{children:[e.jsx(D,{onClick:()=>t(),children:e.jsx(o,{message:"Cancel"})}),e.jsx(D,{variant:"flat",color:"primary",type:"submit",form:a,disabled:!m.formState.isDirty,children:e.jsx(o,{message:"Save"})})]})]})}function Ae({selectedThemeId:s,onSelectionChange:a,allThemes:t}){return e.jsx(z,{size:"sm",selectionMode:"single",selectedValue:s,onSelectionChange:r=>a(r),appearance:"dropdown",children:t.map(r=>e.jsx(y,{value:r.id,children:r.name},r.id))})}function I(s){return Z(s).toString("rgb").replace("rgb(","").replace(")","").replace(/, ?/g," ")}function _e({label:s,colorName:a,initialThemeValue:t,themeId:r,size:l="lg"}){const m=v(n=>n.preview),{setValue:i,getValues:h}=S(),[c,d]=p.useState(t),f=n=>{d(n),m.setThemeValue(a,n)};return p.useEffect(()=>{d(t)},[t]),e.jsxs(N,{value:X(c),type:"popover",placement:"right",offset:10,onValueChange:n=>{f(I(n))},onClose:(n,{valueChanged:x,initialValue:u})=>{if(n&&x){const g=h("themes").findIndex(b=>b.id===r);i(`themes.${g}.values.${a}`,I(n),{shouldDirty:!0})}else f(u?I(u):"")},children:[e.jsx(fe,{size:l,radius:"rounded-panel",startIcon:e.jsx(ve,{viewBox:"0 0 48 48",className:"icon-lg",style:{fill:c.startsWith("#")?c:`rgb(${c})`}}),children:s}),e.jsx(ke,{})]})}const Me=[{label:j("Background"),key:"--be-background"},{label:j("Background alt"),key:"--be-bg-alt"},{label:j("Background elevated"),key:"--be-bg-elevated"},{label:j("Foreground"),key:"--be-fg-base"},{label:j("Accent light"),key:"--be-primary-light"},{label:j("Accent"),key:"--be-primary"},{label:j("Accent dark"),key:"--be-primary-dark"},{label:j("Text on accent"),key:"--be-on-primary"},{label:j("Chip"),key:"--be-bg-chip"}],Be={"rounded-none":{label:j("Square"),value:"0px"},rounded:{label:j("Small"),value:"0.25rem"},"rounded-md":{label:j("Medium"),value:"0.375rem"},"rounded-lg":{label:j("Large"),value:"0.5rem"},"rounded-xl":{label:j("Larger"),value:"0.75rem"},"rounded-full":{label:j("Pill"),value:"9999px"}},$e=""+new URL("font-bxNTk0j0.svg",import.meta.url).href;function Le({state:{filters:s,setFilters:a}}){const{trans:t}=ee();return e.jsxs("div",{className:"mb-24 items-center gap-24 @xs:flex",children:[e.jsx(se,{className:"mb-12 flex-auto @xs:mb-0",value:s.query,onChange:r=>{a({...s,query:r.target.value})},startAdornment:e.jsx(te,{}),placeholder:t(j("Search fonts"))}),e.jsxs(z,{className:"flex-auto",selectionMode:"single",selectedValue:s.category,onSelectionChange:r=>{a({...s,category:r})},children:[e.jsx(y,{value:"",children:e.jsx(o,{message:"All categories"})}),e.jsx(y,{value:"serif",children:e.jsx(o,{message:"Serif"})}),e.jsx(y,{value:"sans-serif",children:e.jsx(o,{message:"Sans serif"})}),e.jsx(y,{value:"display",children:e.jsx(o,{message:"Display"})}),e.jsx(y,{value:"handwriting",children:e.jsx(o,{message:"Handwriting"})}),e.jsx(y,{value:"monospace",children:e.jsx(o,{message:"Monospace"})})]})]})}const Re=[{label:j("System"),family:'ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"',category:"sans-serif"},{family:"Impact, Charcoal, sans-serif",category:"sans-serif"},{family:"Arial, Helvetica Neue, Helvetica, sans-serif",category:"serif"},{family:'"Comic Sans MS", cursive, sans-serif',category:"Handwriting"},{family:"Century Gothic, sans-serif",category:"sans-serif"},{family:'"Courier New", Courier, monospace',category:"monospace"},{family:'"Lucida Sans Unicode", "Lucida Grande", sans-serif',category:"sans-serif"},{family:'"Times New Roman", Times, serif',category:"serif"},{family:'"Lucida Console", Monaco, monospace',category:"monospace"},{family:'"Andele Mono", monospace, sans-serif',category:"sans-serif"},{family:"Verdana, Geneva, sans-serif",category:"sans-serif"},{family:'"Helvetica Neue", Helvetica, Arial, sans-serif',category:"sans-serif"}];function Ee(s,a){return s.reduce((t,r,l)=>{const m=Math.floor(l/a);return t[m]||(t[m]=[]),t[m].push(r),t},[])}function qe({value:s,onChange:a}){const{data:t,isLoading:r}=ae(["googleFonts"]),[l,m]=p.useState(0),[i,h]=p.useState({query:"",category:(s==null?void 0:s.category)??""}),{contains:c}=we({sensitivity:"base"}),d=p.useMemo(()=>Re.concat((t==null?void 0:t.googleFonts)??[]),[t==null?void 0:t.googleFonts]),f=p.useMemo(()=>d.filter(g=>{var b;return c(g.family,i.query)&&(!i.category||((b=g.category)==null?void 0:b.toLowerCase())===i.category.toLowerCase())}),[d,i,c]),n=p.useMemo(()=>Ee(f,20),[f]),x=n[l];p.useEffect(()=>{if(t&&(s!=null&&s.family)){const g=f.findIndex(b=>b.family===s.family);g>=0&&m(Math.floor(g/20))}},[t,f,s==null?void 0:s.family]),p.useEffect(()=>{x!=null&&x.length&&ie(x,{id:"font-selector"})},[x,l]);const u=p.useCallback(g=>{h(g),m(0)},[]);return{fonts:x||[],currentPage:l,filteredFonts:f||[],setCurrentPage:m,isLoading:r,filters:i,setFilters:u,value:s,onChange:a,pages:n}}function He({state:{currentPage:s=0,setCurrentPage:a,filteredFonts:t,pages:r}}){const l=(t==null?void 0:t.length)||0;return e.jsxs("div",{className:"mt-30 flex items-center justify-end gap-24 border-t pt-14 text-sm",children:[l>0&&e.jsx("div",{children:e.jsx(o,{message:":from - :to of :total",values:{from:s*20+1,to:Math.min((s+1)*20,l),total:l}})}),e.jsxs("div",{className:"text-muted",children:[e.jsx(C,{disabled:s<1,onClick:()=>{a(Math.max(0,s-1))},children:e.jsx(re,{})}),e.jsx(C,{disabled:s>=r.length-1,onClick:()=>{a(s+1)},children:e.jsx(Ce,{})})]})]})}function Oe(s){const a=qe(s);return e.jsxs("div",{className:s.className,children:[e.jsx(Le,{state:a}),e.jsx(ne,{initial:!1,mode:"wait",children:e.jsx(Ue,{state:a})}),e.jsx(He,{state:a})]})}function Ue({state:s}){const{isLoading:a,fonts:t}=s,r="grid gap-24 grid-cols-[repeat(auto-fill,minmax(90px,1fr))] items-start";return a?e.jsx(ze,{className:r}):t!=null&&t.length?e.jsx(H.div,{...O,className:r,children:t==null?void 0:t.map(l=>e.jsx(We,{font:l,state:s},l.family))},"font-list"):e.jsx(oe,{className:"mt-60",size:"sm",image:e.jsx(le,{src:$e}),title:e.jsx(o,{message:"No matching fonts"}),description:e.jsx(o,{message:"Try another search query or different category"})})}function We({font:s,state:{value:a,onChange:t}}){const r=(a==null?void 0:a.family)===s.family,l=s.family.split(",")[0].replace(/"/g,"");return e.jsxs(U,{display:"block",onClick:()=>{t(s)},children:[e.jsx("span",{className:V("flex aspect-square items-center justify-center rounded-panel border text-4xl transition-bg-color hover:bg-hover md:text-5xl",r&&"ring-2 ring-primary ring-offset-2"),children:e.jsx("span",{style:{fontFamily:s.family},children:"Aa"})}),e.jsx("span",{className:V("mt-6 block overflow-hidden overflow-ellipsis whitespace-nowrap text-sm",r&&"text-primary"),children:s.label?e.jsx(o,{...s.label}):l})]},s.family)}function ze({className:s}){const a=Array.from(Array(20).keys());return e.jsx(H.div,{...O,className:s,children:a.map(t=>e.jsxs("div",{children:[e.jsx("div",{className:"aspect-square",children:e.jsx(M,{display:"block",variant:"rect"})}),e.jsx(M,{className:"mt-6 text-sm"})]},t))},"font-list-skeleton")}function Ms(){var l,m;const{data:s}=_(),{auth:a}=p.use(ce),t=s.themes.filter(i=>i.type==="site"),r=A({defaultValues:{themes:t,client:{themes:{default_id:(l=s.client.themes)!=null&&l.default_id?parseInt(s.client.themes.default_id):0,user_change:((m=s.client.themes)==null?void 0:m.user_change)??!1}}}});return e.jsxs(k,{title:e.jsx(o,{message:"Themes"}),defaultRoute:me().auth_redirect_uri??"/",docsLink:he.settings.themes,children:[e.jsx(k.Content,{children:e.jsxs(k.Form,{form:r,children:[e.jsxs("div",{className:"mb-20 border-b pb-20",children:[e.jsxs(Se,{className:"mb-20",size:"sm",name:"client.themes.default_id",selectionMode:"single",label:e.jsx(o,{message:"Default site theme"}),children:[e.jsx(y,{value:0,children:e.jsx(o,{message:"System"})}),t.map(i=>e.jsx(y,{value:i.id,children:i.name},i.id))]}),e.jsx(w,{name:"client.themes.user_change",children:e.jsx(o,{message:"Allow users to switch theme"})})]}),e.jsx(Pe,{})]})}),e.jsx(k.Preview,{})]})}function Pe({size:s="lg",type:a="site"}){var f;const t=v(n=>n.preview),r=S(),l=de({name:"themes"}).filter(n=>n.type===a),{selectedTheme:m}=ue(),[i,h]=p.useState(()=>{var x;const n=l.find(u=>u.id===m.id);return n?n.id:(x=l[0])==null?void 0:x.id}),c=r.watch("themes").find(n=>n.id===i),d=n=>{if(n===i)return;h(n);const x=r.getValues("themes").find(u=>u.id===n);x&&t.setActiveTheme(x.id)};return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-24 flex items-center gap-8",children:[e.jsx(Ae,{selectedThemeId:i,onSelectionChange:d,allThemes:l}),e.jsx(De,{selectedThemeId:i,initialThemeId:m.id,onSelectedThemeChange:d}),e.jsx(Te,{type:a,onCreated:d})]}),e.jsxs(Ne,{variant:"outline",size:s,className:"mb-10",children:[e.jsx(B,{fontClassName:"text-sm",label:e.jsx(o,{message:"Font"}),descriptionClassName:"overflow-hidden text-ellipsis whitespace-nowrap text-xs text-muted",description:(f=c==null?void 0:c.font)!=null&&f.family?c.font.family:e.jsx(o,{message:"System"}),children:e.jsx(Ke,{themeId:i})}),e.jsxs(B,{label:e.jsx(o,{message:"Rounding"}),fontClassName:"text-sm",children:[e.jsx(T,{label:e.jsx(o,{message:"Button rounding"}),name:"button-radius",themeId:i,className:"mb-24"}),e.jsx(T,{label:e.jsx(o,{message:"Input rounding"}),name:"input-radius",themeId:i,className:"mb-24"}),e.jsx(T,{label:e.jsx(o,{message:"Panel rounding"}),name:"panel-radius",hidePill:!0,themeId:i})]})]}),Me.map(n=>e.jsx(_e,{colorName:n.key,size:s,label:e.jsx(o,{...n.label}),initialThemeValue:(c==null?void 0:c.values[n.key])??"",themeId:i},n.key))]})}function Ke({themeId:s}){const a=v(i=>i.preview),{setValue:t,watch:r}=S(),m=`themes.${r("themes").findIndex(i=>i.id===s)}.font`;return e.jsx(Oe,{value:r(m),onChange:i=>{t(m,i,{shouldDirty:!0}),a.setThemeFont(i)}})}function T({label:s,name:a,hidePill:t,themeId:r,className:l}){const m=v(n=>n.preview),{watch:i,setValue:h}=S(),d=`themes.${i("themes").findIndex(n=>n.id===r)}.values.--be-${a}`,f=i(d);return e.jsxs("div",{className:l,children:[e.jsx("div",{className:"mb-10 text-sm font-semibold",children:s}),e.jsx("div",{className:"grid grid-cols-3 gap-10 text-sm",children:Object.entries(Be).filter(([n])=>!t||!n.includes("full")).map(([n,{label:x,value:u}])=>e.jsx(U,{display:"block",className:V("h-36 border-2 hover:bg-hover",n,u===f&&"border-primary"),onClick:()=>{h(d,u,{shouldDirty:!0}),m.setThemeValue(`--be-${a}`,u)},children:e.jsx(o,{...x})},n))})]})}export{Ms as Component,Pe as ThemeEditor};
