import{j as t,at as v,r as n,cH as C,bo as N,a9 as y,v as I,av as A,u as F,T as h,c1 as L}from"./main-CUJEGI8U.js";import{o as p,P as S,q as k,u as w}from"./share-media-button-Dw3JV4C-.js";import{A as D,a as B}from"./avatar-group-DBzfgZws.js";import{o as E,a as g}from"./offline-media-items-Dlxt2ETB.js";import{u as O}from"./add-to-queue-menu-button-AYv4MHMe.js";import{A as _}from"./album-image-CkUJpPZs.js";import{A as G}from"./album-link-DwfnHHp7.js";import{g as M}from"./artist-link-XkkvBaYk.js";import{G as q}from"./genre-link-DnbOgUf-.js";import{B as H}from"./bullet-separated-items-DSt8aXIS.js";import{M as Q,a as j}from"./media-page-header-layout-B2pd5UBI.js";import{P as $}from"./player-page-header-gradient-B98PHS1w.js";import{P as W}from"./player-page-suspsense-nQjKTdHX.js";import{u as z,T as R,C as U}from"./truncated-description-C-aw2Igq.js";import{u as V}from"./use-track-permissions-ChTh4jJA.js";import{C as J,b as K,T as X}from"./comment-bar-new-comment-form-CyGo8E79.js";import{T as Y}from"./track-image-B3DSRXTB.js";import{T as Z}from"./track-table-CY1bAvY-.js";import{t as ee}from"./track-context-dialog-DU1dwrB2.js";import{W as te}from"./waveform-O_aCNRMS.js";import{A as b}from"./ad-host-3MKQnMjM.js";import{P as re}from"./page-meta-tags-CEAowLoU.js";import{u as T}from"./use-required-params-Cp5Jywbp.js";import{u as se}from"./use-sortable-table-data-wSD3nGow.js";import{u as oe}from"./useSuspenseQuery-13TuSADp.js";import{C as ae}from"./chip-list-D0uDB84E.js";import{F as ie}from"./formatted-date-DzIPJwiH.js";import{F as me}from"./formatted-duration-2_MIaPa4.js";import{F as ne}from"./formatted-number-gsF1qEbc.js";import"./play-arrow-filled-BrHo1wfG.js";import"./use-player-store-BWFGgN3k.js";import"./is-ctrl-or-shift-pressed-Bx-mqgCW.js";import"./middleware-BLXTWOs6.js";import"./traditional-BcYcLesO.js";import"./Pause-B4fj-x54.js";import"./create-playlist-dialog-DeyZkjsM.js";import"./image-selector-GLpYAkj6.js";import"./file-upload-provider-DWaB2xE4.js";import"./uploaded-file-ksxfN_l-.js";import"./extension-from-filename-O0XMuZye.js";import"./pretty-bytes-bO14ePu9.js";import"./use-active-upload-BwzDBsep.js";import"./open-upload-window-CboR35vP.js";import"./AddAPhoto-y5pGVyq2.js";import"./file-input-config-DrcTpI3-.js";import"./switch-4KDjemPX.js";import"./Image-DWFqsH18.js";import"./dialog-footer-jZcc-BBM.js";import"./use-auth-click-capture-B9wu-BP4.js";import"./Add-B3RL66ee.js";import"./KeyboardArrowRight-CjTKdvdU.js";import"./FavoriteBorder-D1CUmnAo.js";import"./use-previous-BgqS7ski.js";import"./small-artist-image-BqXmK0zy.js";import"./Mic-DAPkQZuC.js";import"./playlist-image-zogte8rn.js";import"./PlaylistPlay-DcgxbGJx.js";import"./playlist-link-CLw6NzkW.js";import"./share-media-buttons-DtF-m4-I.js";import"./Share-C8wHCu8Q.js";import"./track-link-D8mIwI0F.js";import"./tabs-BVjOaE7L.js";import"./tab-panels-BNEb_18b.js";import"./use-clipboard-CQvDhy4G.js";import"./check-circle-filled-BwqtgJPU.js";import"./Download-rbsKggzM.js";import"./Album-pwm22nnR.js";import"./external-link-jlnQ3iTs.js";import"./use-delete-comments-Gq9uGbac.js";import"./Reply-CVpUZh9g.js";import"./MoreVert-BiULonS7.js";import"./confirmation-dialog-DVMbD2S1.js";import"./infinite-scroll-sentinel-Br7e5Kqx.js";import"./use-flat-infinite-query-items-3ilhvvhN.js";import"./useSuspenseInfiniteQuery-Vh8v-EaZ.js";import"./infiniteQueryObserver-CQEL_EnT.js";import"./Comment-vFUyF-gf.js";import"./skeleton-BmWW5Jc-.js";import"./use-linkified-string-DMs78B9_.js";import"./linkify-Cbuu_PPG.js";import"./album-context-dialog-C5eIuCxr.js";import"./use-delete-album-VPJfiJbG.js";import"./use-album-permissions-_OgAnUnz.js";import"./artist-links-YW81uP4U.js";import"./toggle-in-library-menu-button-CqmQ1GOD.js";import"./toggle-repost-menu-button-DAsBpr-F.js";import"./Repeat-DTFydNM6.js";import"./MoreHoriz-RUUnngeG.js";import"./MusicNote-SjrQa4Nt.js";import"./table-CgoYghfp.js";import"./checkbox-suk8vW77.js";import"./CheckBoxOutlineBlank-BgWeDdny.js";import"./ArrowDownward-BHYKFIfy.js";import"./useInteractOutside-BFJZ3Z5N.js";import"./useEffectEvent-pADbdn7r.js";import"./use-pointer-events-DcvSqvAc.js";import"./useGlobalListeners-BeXr-yG1.js";import"./entitiy-offline-indicator-icon-B5v2rY9X.js";import"./like-icon-button-ppQBH-Cs.js";import"./Schedule-D2nn-qO3.js";import"./TrendingUp-hWFiGDg8.js";import"./use-should-show-radio-button-CEtJUckB.js";import"./download-file-from-url-BVaKcxRP.js";import"./use-slider-B78Jo8sh.js";import"./generate-waveform-data-BFwf5N3g.js";import"./getScrollParent--OCc5gFh.js";import"./default-meta-tags-Cim_8kSD.js";import"./sort-array-of-objects-OJAulda_.js";import"./use-date-formatter-m8TmZzOM.js";import"./DateFormatter-Dix9bfnP.js";import"./use-current-date-time-BhbL04rR.js";function br(){return t.jsx(W,{offlineFallback:t.jsx(fe,{}),children:t.jsx(le,{})})}function le(){const{trackId:e}=T(["trackId"]),s=oe(v.tracks.get(e,"trackPage"));return t.jsx(P,{data:s.data})}function pe({album:e,track:s}){var m;const i=(m=e==null?void 0:e.tracks)!=null&&m.length?e.tracks:[s],{data:r,sortDescriptor:o,onSortChange:a}=se(i);return t.jsxs("div",{className:"mt-44",children:[t.jsxs("div",{className:"mb-14 flex items-center gap-16 overflow-hidden rounded bg-hover",children:[t.jsx(_,{album:e,className:"flex-shrink-0 rounded",size:"w-70 h-70"}),t.jsxs("div",{className:"flex-auto",children:[t.jsx("div",{className:"text-sm",children:t.jsx(h,{message:"From the album"})}),t.jsx("div",{className:"text-sm font-semibold",children:t.jsx(G,{album:e})})]})]}),t.jsx(Z,{queueGroupId:k(e),tracks:r,sortDescriptor:o,onSortChange:a,hideTrackImage:!0,hideAlbum:!0,hidePopularity:!1})]})}function ce({track:e}){var c,u,f,d,x;const s=A(),i=O(),{player:r}=F(),o=((c=e.album)==null?void 0:c.release_date)||e.created_at,a=(u=e.genres)==null?void 0:u[0],m=!s&&(r==null?void 0:r.seekbar_type)==="waveform"&&ee(e);return t.jsx(n.Fragment,{children:t.jsx(Q,{image:t.jsx(Y,{track:e,className:"rounded-panel"}),title:e.name,subtitle:t.jsx(D,{children:(f=e.artists)==null?void 0:f.map(l=>t.jsx(L,{circle:!0,src:l.image_small,label:l.name,link:M(l)},l.id))}),description:t.jsxs(H,{className:"text-sm",children:[e.duration?t.jsx(me,{ms:e.duration,verbose:!0}):null,o&&t.jsx(ie,{date:o}),a&&t.jsx(q,{genre:a}),e.plays&&!(r!=null&&r.enable_repost)?t.jsx(h,{message:":count plays",values:{count:t.jsx(ne,{value:e.plays})}}):null]}),actionsBar:t.jsxs(X,{item:e,managesItem:!1,buttonGap:void 0,buttonSize:"sm",buttonClassName:j(),children:[t.jsx(S,{buttonType:"text",track:e,tracks:(x=(d=e.album)==null?void 0:d.tracks)!=null&&x.length?e.album.tracks:void 0,className:j({isFirst:!0}),queueId:k(e.album||e)}),i?t.jsx(ue,{track:e}):null]}),footer:m?t.jsx(te,{track:e,className:"max-md:hidden"}):void 0})})}function P({data:e}){var o;const{canView:s,canCreate:i}=z(),{canEdit:r}=V([e.track]);return t.jsxs(t.Fragment,{children:[e.track.image&&t.jsx($,{image:e.track.image}),t.jsxs("div",{className:"relative",children:[t.jsxs(J,{children:[t.jsx(re,{data:e}),t.jsx(b,{slot:"general_top",className:"mb-44"}),t.jsx(ce,{track:e.track}),i?t.jsx(K,{className:"mb-16",commentable:e.track}):null]}),(o=e.track.tags)!=null&&o.length?t.jsx(N,{children:t.jsx(ae,{className:"mb-16",color:"bg-fg-base/8",selectable:!0,children:e.track.tags.map(a=>t.jsxs(y,{elementType:I,to:`/tag/${a.name}`,children:["#",a.display_name||a.name]},a.id))})}):null,t.jsx(R,{description:e.track.description,className:"mt-24 text-sm"}),s?t.jsx(U,{className:"mt-34",commentable:e.track,canDeleteAllComments:r}):null,e.track.album&&t.jsx(pe,{album:e.track.album,track:e.track}),t.jsx(b,{slot:"general_bottom",className:"mt-44"})]})]})}function ue({track:e}){const[s,i]=n.useState(0),r=w(o=>o.offlinedTrackIds.has(e.id));return n.useEffect(()=>{if(r){const o=()=>{const a=g.getDownloadProgress().entries().find(([m])=>m===e.id);i((a==null?void 0:a[1])??0)};return o(),g.listen("onActiveDownloadsChanged",o)}},[r]),t.jsx(B,{isOfflined:r,className:"mr-8",progress:s,onClick:()=>{r?p().deleteOfflinedTracks([e]):p().offlineTracks([e])}})}function fe(){const[e,s]=n.useState(null),[i,r]=n.useState(!0),{trackId:o}=T(["trackId"]);return n.useEffect(()=>{de(+o).then(s).finally(()=>r(!1))},[o]),e?t.jsx(P,{data:e}):i?null:t.jsx(C,{})}async function de(e){if(!p().offlinedTrackIds.has(e))return null;const s=await E.get(e),i=s==null?void 0:s.data;return i?{loader:"trackPage",track:i}:null}export{br as Component};
