import{j as e,T as t,v as c,W as v,u as T,a8 as I,a9 as P,z as A,G as d,H as p,aa as u,Y as g,I as x,J as h,b as j,r as y,S as H,ab as N,D as k,t as f,a4 as M,ac as E,ad as L,a5 as F,Q as q,$ as b}from"./main-CUJEGI8U.js";import{E as z}from"./Edit-BRVJ8AkN.js";import{H as B}from"./Home-BlCODD9a.js";import{F as Q}from"./formatted-date-DzIPJwiH.js";import{C as $}from"./channels-docs-link-CASgP5UZ.js";import{u as W,a as _,G as K,D as G,b as R,c as U}from"./use-datatable-query-D9uebfzx.js";import{D as J}from"./data-table-add-item-button-_qDHIKil.js";import{a as V,D as Y,b as O,c as X}from"./datatable-page-with-header-layout-C4e5sJMc.js";import{T as Z}from"./table-CgoYghfp.js";import{C as D}from"./confirmation-dialog-DVMbD2S1.js";import{p as ee}from"./playlist-WVznIqu7.js";import"./use-date-formatter-m8TmZzOM.js";import"./DateFormatter-Dix9bfnP.js";import"./admin-config-DTFkVWJm.js";import"./Album-pwm22nnR.js";import"./Comment-vFUyF-gf.js";import"./FileUpload-CTBOdaGq.js";import"./Mic-DAPkQZuC.js";import"./PlaylistPlay-DcgxbGJx.js";import"./QueueMusic-CiX-EN5z.js";import"./Sell-D56iqjs7.js";import"./settings-links-6v3CjZ6H.js";import"./external-link-jlnQ3iTs.js";import"./FilterAlt-Cw-mRuQp.js";import"./form-normalized-model-chip-field-R33Z1aXc.js";import"./use-normalized-models-ClA2DWxP.js";import"./form-chip-field-ehb7ckkp.js";import"./input-DAWJLQiY.js";import"./chip-list-D0uDB84E.js";import"./accordion-BALGWyw-.js";import"./checkbox-suk8vW77.js";import"./CheckBoxOutlineBlank-BgWeDdny.js";import"./ArrowRightAlt-iO8zeT1U.js";import"./DateRange-Bhvye4F9.js";import"./use-base-date-picker-state-DaWG2IMs.js";import"./KeyboardArrowRight-CjTKdvdU.js";import"./use-date-range-picker-state-CSWp3d1-.js";import"./list-C96mDrnJ.js";import"./switch-4KDjemPX.js";import"./dialog-footer-jZcc-BBM.js";import"./is-tablet-media-query-DhMPnSWn.js";import"./use-current-date-time-BhbL04rR.js";import"./select-Z9R0wV6S.js";import"./combobox-end-adornment-B0xReOuL.js";import"./normalized-model-field-8T9JWy8W.js";import"./skeleton-BmWW5Jc-.js";import"./Add-B3RL66ee.js";import"./dashboard-layout-context-DeTNv3yG.js";import"./ArrowDownward-BHYKFIfy.js";import"./useInteractOutside-BFJZ3Z5N.js";import"./useEffectEvent-pADbdn7r.js";import"./is-ctrl-or-shift-pressed-Bx-mqgCW.js";import"./use-pointer-events-DcvSqvAc.js";import"./useGlobalListeners-BeXr-yG1.js";const ae=[{key:"name",allowsSorting:!0,width:"flex-3",visibleInMode:"all",header:()=>e.jsx(t,{message:"Name"}),body:a=>e.jsxs("div",{children:[e.jsx("div",{className:"overflow-hidden overflow-ellipsis whitespace-nowrap font-medium",children:e.jsx(se,{channel:a})}),a.config.adminDescription&&e.jsx("p",{className:"max-w-680 whitespace-normal text-xs text-muted",children:a.config.adminDescription})]})},{key:"content",allowsSorting:!1,header:()=>e.jsx(t,{message:"Content"}),body:a=>e.jsx(te,{channel:a})},{key:"content_type",allowsSorting:!1,header:()=>e.jsx(t,{message:"Content type"}),body:a=>e.jsx("span",{className:"capitalize",children:a.config.contentModel?e.jsx(t,{message:a.config.contentModel}):void 0})},{key:"internal",allowsSorting:!0,maxWidth:"max-w-100",hideHeader:!0,header:()=>e.jsx(t,{message:"Internal"}),body:a=>e.jsx(ne,{channel:a})},{key:"updated_at",allowsSorting:!0,maxWidth:"max-w-100",header:()=>e.jsx(t,{message:"Last updated"}),body:a=>a.updated_at?e.jsx(Q,{date:a.updated_at}):""},{key:"actions",header:()=>e.jsx(t,{message:"Actions"}),hideHeader:!0,visibleInMode:"all",align:"end",width:"w-42 flex-shrink-0",body:a=>e.jsx(c,{to:`${a.id}/edit`,className:"text-muted",children:e.jsx(v,{size:"md",children:e.jsx(z,{})})})}];function te({channel:a}){switch(a.config.contentType){case"listAll":return e.jsx(t,{message:"List all"});case"manual":return e.jsx(t,{message:"Managed manually"});case"autoUpdate":return e.jsx(t,{message:"Updated automatically"})}}function se({channel:a}){return a.config.restriction&&a.config.restrictionModelId==="urlParam"?a.name:e.jsx("a",{className:"outline-none hover:underline focus-visible:underline",href:`channel/${a.slug}`,target:"_blank",rel:"noreferrer",children:a.name})}function ne({channel:a}){const{homepage:s}=T(),n=a.internal?e.jsx(I,{label:e.jsx(t,{message:"This channel is required for some site functionality to work properly and can't be deleted."}),children:e.jsx("div",{children:e.jsx(P,{className:"w-max",size:"xs",radius:"rounded-panel",children:e.jsx(t,{message:"Internal"})})})}):"",r=(s==null?void 0:s.type)==="channels"&&`${s.value}`==`${a.id}`;return e.jsxs("div",{className:"flex items-center gap-6",children:[n,r?e.jsx(B,{className:"text-muted",size:"sm"}):null]})}function re(){const{trans:a}=A();return d({mutationFn:s=>oe(s),onSuccess:async()=>{await u.invalidateQueries({queryKey:g.invalidateKey}),x(a(h("Channel preset applied")))},onError:s=>p(s)})}function oe(a){return j.post("channel/apply-preset",a).then(s=>s.data)}function ca(){var m;const[a,s]=y.useState([]),{searchParams:n,sortDescriptor:r,mergeIntoSearchParams:o,setSearchQuery:C,isFiltering:w}=W(N),i=_(g.index(n)),S=e.jsxs(k,{type:"modal",children:[e.jsx(f,{variant:"flat",color:"danger",children:e.jsx(t,{message:"Delete"})}),e.jsx(me,{selectedIds:a,onDelete:()=>s([])})]});return e.jsxs(V,{children:[e.jsx(K,{query:i}),e.jsx(H,{children:e.jsx(t,{message:"Channels"})}),e.jsx(Y,{title:e.jsx(t,{message:"Channels"}),rightContent:e.jsx($,{variant:"button"}),showSidebarToggleButton:!0}),e.jsxs(O,{children:[e.jsx(G,{searchValue:n.query,onSearchChange:C,actions:e.jsx(ie,{presets:(m=i.data)==null?void 0:m.presets}),selectedItems:a,selectedActions:S}),e.jsxs(X,{children:[e.jsx(Z,{cellHeight:"h-52",columns:ae,data:i.items,sortDescriptor:r,onSortChange:o,enableSelection:!0,selectedRows:a,onSelectionChange:s}),i.isEmpty&&e.jsx(R,{isFiltering:w,image:ee,title:e.jsx(t,{message:"No channels have been created yet"}),filteringTitle:e.jsx(t,{message:"No matching channels"})}),e.jsx(U,{query:i,onPageChange:l=>o({page:l}),onPerPageChange:l=>o({perPage:l})})]})]})]})}function ie({presets:a}){return e.jsxs(y.Fragment,{children:[e.jsxs(M,{onItemSelected:s=>E(le,{preset:s}),children:[e.jsx(f,{variant:"outline",color:"primary",size:"sm",endIcon:e.jsx(L,{}),disabled:!(a!=null&&a.length),children:e.jsx(t,{message:"Apply preset"})}),e.jsx(F,{children:a==null?void 0:a.map(s=>e.jsx(q,{value:s.preset,description:e.jsx(t,{message:s.description}),children:e.jsx(t,{message:s.name})},s.preset))})]}),e.jsx(J,{elementType:c,to:"new",children:e.jsx(t,{message:"Add new channel"})})]})}function le({preset:a}){const{close:s}=b(),n=re();return e.jsx(D,{isLoading:n.isPending,onConfirm:()=>{n.mutate({preset:a},{onSuccess:()=>s()})},isDanger:!0,title:e.jsx(t,{message:"Apply preset"}),body:e.jsx(t,{message:"Are you sure you want to apply this channel preset? This will delete all current channels and leave only channels from the selected preset."}),confirm:e.jsx(t,{message:"Apply"})})}function me({selectedIds:a,onDelete:s}){const{close:n}=b(),r=d({mutationFn:()=>j.delete(`channel/${a.join(",")}`),onSuccess:async()=>{await u.invalidateQueries({queryKey:["channels"]}),x(h("Channels deleted")),s(),n()},onError:o=>p(o)});return e.jsx(D,{isDanger:!0,isLoading:r.isPending,title:e.jsx(t,{message:"Delete channels"}),body:e.jsx(t,{message:"Are you sure you want to delete selected channels?",values:{count:a.length}}),confirm:e.jsx(t,{message:"Delete"}),onConfirm:()=>r.mutate()})}export{ca as Component};
