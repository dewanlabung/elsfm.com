import{j as e,o as v,p as A,d as P,z as T,r as n,ar as k,J as I,ao as C,A as G,T as p}from"./main-CUJEGI8U.js";import{b as u}from"./offline-media-items-Dlxt2ETB.js";import{A as L}from"./album-grid-item-gFm1NFxn.js";import{M as S}from"./media-page-no-results-message--OHhXdwX.js";import{L as E}from"./library-page-sort-dropdown-DGgwBabF.js";import{C as N}from"./content-grid-hmapBiIW.js";import{S as b}from"./skeleton-BmWW5Jc-.js";import{b as F}from"./playlist-context-dialog-DH_eECE6.js";import{u as R}from"./use-filter-cTKMA7-l.js";import{s as q}from"./sort-array-of-objects-OJAulda_.js";function z({itemCount:l,itemRadius:s,showDescription:d=!0}){return e.jsx(v.div,{...A,children:e.jsx(N,{children:[...new Array(Math.min(l,30)).keys()].map(r=>e.jsxs("div",{className:"relative w-full",children:[e.jsx("div",{className:"aspect-square w-full",children:e.jsx(b,{variant:"rect",radius:s})}),e.jsxs("div",{className:P("mt-12 text-xs",!d&&"pt-[3px]"),children:[e.jsx(b,{variant:"text"}),d&&e.jsx(b,{variant:"text",className:"mt-[7px]"})]})]},r))})},"skeletons")}function Z({sortItems:l,type:s}){const{trans:d}=T(),[r,w]=n.useState({orderBy:"lastSyncedAt",orderDir:"desc"}),[m,M]=n.useState(!0),[x,D]=n.useState(""),[c,f]=n.useState([]),{contains:y}=R({sensitivity:"base"}),h=n.useMemo(()=>{const t=c.filter(j=>y(j.data.name,x));return q(t,r.orderBy,r.orderDir)},[c,x,r,y]);return n.useEffect(()=>{if(!m)return;(s==="album"?u.getAllAlbums():u.getAllPlaylists()).then(a=>{f(a)}).finally(()=>{M(!1)});const t=u.listen("onItemUpdated",a=>{a.type===s&&f(i=>{const o=i.findIndex(g=>g.dbId===g.dbId);return o!==-1?i[o]=a:i.push(a),[...i]})}),j=u.listen("onItemDeleted",a=>{a.type===s&&f(i=>i.filter(o=>o.dbId!==o.dbId))});return()=>{t(),j()}},[m]),e.jsxs("div",{className:"mt-34",children:[e.jsxs("div",{className:"flex items-center justify-between gap-24",children:[e.jsx(k,{value:x,onChange:t=>D(t.target.value),className:"max-w-512 flex-auto",size:"sm",startAdornment:e.jsx(C,{}),placeholder:d(s==="album"?I("Search within albums"):I("Search within playlists"))}),e.jsx(E,{items:l,sortDescriptor:r,setSortDescriptor:w})]}),e.jsxs("div",{className:"mt-34",children:[e.jsx(G,{initial:!1,mode:"wait",children:m?e.jsx(z,{itemCount:c.length}):e.jsx(v.div,{...A,children:e.jsx(N,{children:h.map(t=>s==="album"?e.jsx(L,{album:t.data},t.id):e.jsx(F,{playlist:t.data},t.id))})},"media-grid")}),!h.length&&!m&&e.jsx(B,{type:s,isFiltering:c.length!==h.length})]})]})}function B({type:l,isFiltering:s}){return s?e.jsx(S,{className:"mt-34",description:e.jsx(p,{message:"Try another search query or different filters."})}):e.jsx(S,{className:"mt-34",description:l==="album"?e.jsx(p,{message:"You have not downloaded any albums yet."}):e.jsx(p,{message:"You have not downloaded any playlists yet."})})}export{Z as D};
