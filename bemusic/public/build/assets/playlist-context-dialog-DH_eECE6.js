import{a as K,at as m,e as P,G as C,H as b,I as c,J as d,aa as h,b as y,j as t,W as k,t as v,T as a,aw as Q,q as $,ae as G,$ as r,r as D,ac as M,aM as R}from"./main-CUJEGI8U.js";import{C as W,c as l,d as H,l as _,q as J,u as N,o as p}from"./share-media-button-Dw3JV4C-.js";import{A as V,u as X}from"./add-to-queue-menu-button-AYv4MHMe.js";import{U as Y,u as B}from"./update-playlist-dialog-D3q_Y3lO.js";import{P as Z}from"./entitiy-offline-indicator-icon-B5v2rY9X.js";import{P as z}from"./playable-grid-item-Cb5d38jQ.js";import{P as T}from"./playlist-image-zogte8rn.js";import{g as E,P as O}from"./playlist-link-CLw6NzkW.js";import{C as ee}from"./confirmation-dialog-DVMbD2S1.js";import{u as te}from"./use-clipboard-CQvDhy4G.js";import{F as I,a as F}from"./FavoriteBorder-D1CUmnAo.js";function S(e){const{data:s}=K(m.playlists.compactAuthUserPlaylists()),{user:n}=P(),i=s==null?void 0:s.find(o=>o.id===+e);return!!(i&&n&&n.id!==i.owner_id)}function u(e){const{user:s}=P(),n=!!(s!=null&&s.id&&s.id===e.owner_id);return{canEdit:n,canDelete:n,isCreator:n}}function U(e){return C({mutationFn:()=>se(e.id),onSuccess:()=>{c(d("Following :name",{values:{name:e.name}})),h.invalidateQueries({queryKey:m.playlists.invalidateKey})},onError:s=>b(s)})}function se(e){return y.post(`playlists/${e}/follow`).then(s=>s.data)}function q(e){return C({mutationFn:()=>ne(e.id),onSuccess:()=>{c(d("Stopped following :name",{values:{name:e.name}})),h.invalidateQueries({queryKey:m.playlists.invalidateKey})},onError:s=>b(s)})}function ne(e){return y.post(`playlists/${e}/unfollow`).then(s=>s.data)}function oe({playlist:e,size:s="sm",className:n,buttonType:i="text",radius:o}){const{isCreator:x}=u(e),g=U(e),j=q(e),w=S(e.id),f=g.isPending||j.isPending;return x?null:i==="icon"?w?t.jsx(k,{size:s,radius:o,color:"primary",className:n,disabled:f,onClick:()=>j.mutate(),children:t.jsx(I,{})}):t.jsx(k,{size:s,radius:o,disabled:f,className:n,onClick:()=>g.mutate(),children:t.jsx(F,{})}):w?t.jsx(v,{size:s,variant:"outline",radius:o||"rounded-full",startIcon:t.jsx(I,{className:"text-primary"}),disabled:f,className:n,onClick:()=>j.mutate(),children:t.jsx(a,{message:"Following"})}):t.jsx(v,{size:s,variant:"outline",radius:o||"rounded-full",startIcon:t.jsx(F,{}),disabled:f,className:n,onClick:()=>g.mutate(),children:t.jsx(a,{message:"Follow"})})}function pe({playlist:e,layout:s}){return t.jsx(z,{layout:s,image:t.jsx(T,{playlist:e}),title:t.jsx(O,{playlist:e}),subtitle:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(Z,{playlistId:e.id}),t.jsx(L,{playlist:e})]}),link:E(e),likeButton:t.jsx(oe,{buttonType:"icon",size:"md",playlist:e}),model:e,contextDialog:t.jsx(ae,{playlist:e})})}function L({playlist:e}){const s=e.editors[0];return s?t.jsx(a,{message:"By :name",values:{name:t.jsx(Q,{user:s})}}):null}function A(e){const{pathname:s}=$(),n=G(),{getRedirectUri:i}=P();return C({mutationFn:()=>ie(e),onSuccess:async()=>{c(d("Playlist deleted")),s.startsWith(`/playlist/${e}`)&&(n(i()),await new Promise(o=>setTimeout(o,200))),h.invalidateQueries({queryKey:m.playlists.invalidateKey,refetchType:"active"})},onError:o=>b(o)})}function ie(e){return y.delete(`playlists/${e}`).then(s=>s.data)}function ae({playlist:e}){const{close:s}=r(),[,n]=te(E(e,{absolute:!0})),{canEdit:i}=u(e),o=D.useCallback(()=>me(e),[e]);return t.jsxs(W,{image:t.jsx(T,{playlist:e}),title:t.jsx(O,{playlist:e}),description:t.jsx(L,{playlist:e}),loadTracks:o,children:[t.jsx(V,{item:e,loadTracks:o}),t.jsx(ue,{playlist:e}),t.jsx(ce,{playlist:e}),t.jsx(le,{playlist:e}),t.jsx(re,{playlist:e}),t.jsx(l,{onClick:()=>{n(),s(),c(d("Copied link to clipboard"))},children:t.jsx(a,{message:"Copy playlist link"})}),e.public&&t.jsx(H,{item:e}),i&&t.jsx(l,{onClick:()=>{s(),M(Y,{playlist:e})},children:t.jsx(a,{message:"Edit"})}),t.jsx(de,{playlist:e})]})}function le({playlist:e}){const s=S(e.id),{close:n}=r(),i=U(e),o=q(e),{isCreator:x}=u(e);return x?null:t.jsx(D.Fragment,{children:s?t.jsx(l,{onClick:()=>{n(),o.mutate()},children:t.jsx(a,{message:"Unfollow"})}):t.jsx(l,{onClick:()=>{n(),i.mutate()},children:t.jsx(a,{message:"Follow"})})})}function re({playlist:e}){const{close:s}=r(),n=X(),i=N(o=>o.offlinedPlaylistIds.has(e.id));return n?t.jsx(l,{enableWhileOffline:!0,onClick:async()=>{s(),i?p().deleteOfflinedMediaItem(e):p().offlineMediaItem(e)},children:i?t.jsx(a,{message:"Remove from this device"}):t.jsx(a,{message:"Make available offline"})}):null}function ue({playlist:e}){const{close:s}=r(),n=B({playlistId:e.id}),{isCreator:i}=u(e);if(!i)return null;const o=()=>{s(),n.mutate({public:!e.public})};return t.jsx(l,{disabled:n.isPending,onClick:()=>o(),children:e.public?t.jsx(a,{message:"Make private"}):t.jsx(a,{message:"Make public"})})}function ce({playlist:e}){const{close:s}=r(),n=B({playlistId:e.id}),{isCreator:i}=u(e);if(!i)return null;const o=()=>{s(),n.mutate({collaborative:!e.collaborative})};return t.jsx(l,{disabled:n.isPending,startIcon:e.collaborative?t.jsx(R,{}):void 0,onClick:()=>o(),children:t.jsx(a,{message:"Collaborative"})})}function de({playlist:e}){const{close:s}=r(),n=A(e.id),{canDelete:i}=u(e);return i?t.jsx(l,{disabled:n.isPending,onClick:()=>{s(),M(fe,{playlistId:e.id})},children:t.jsx(a,{message:"Delete"})}):null}function fe({playlistId:e}){const s=A(e),{close:n}=r();return t.jsx(ee,{isDanger:!0,title:t.jsx(a,{message:"Delete playlist"}),body:t.jsx(a,{message:"Are you sure you want to delete this playlist?"}),confirm:t.jsx(a,{message:"Delete"}),onConfirm:()=>{s.mutate(void 0,{onSuccess:()=>n()})}})}async function me(e){const s=await _(J(e));return s.length||c(d("This playlist has no tracks yet.")),s}export{oe as F,ae as P,L as a,pe as b,u};
