const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./lazy-chart-DtVVyhzz.js","./main-CUJEGI8U.js","./main-CjleJaCk.css"])))=>i.map(i=>d[i]);
import{j as t,d as h,ax as G,T as b,r as m,x as w,z as _,u as E,ay as F,J as v,az as k,aA as T,t as P,aB as K,aC as L,aD as M,aE as O,aF as U}from"./main-CUJEGI8U.js";import{A as q}from"./ArrowBack-1PBB3Hhh.js";import{I as H}from"./info-dialog-trigger-CfT6LuLX.js";import{$ as V}from"./DateFormatter-Dix9bfnP.js";function $(a){const{title:o,description:s,children:e,className:r,contentIsFlex:i=!0,contentClassName:n,contentRef:l}=a;return t.jsxs("div",{className:h("flex flex-auto flex-col rounded-panel border bg-elevated p-20",r),children:[t.jsxs("div",{className:"flex flex-shrink-0 items-center justify-between pb-10 text-xs",children:[t.jsx("div",{className:"text-sm font-semibold",children:o}),s&&t.jsx("div",{className:"text-muted",children:s})]}),t.jsx("div",{ref:l,className:h("relative",i&&"flex flex-auto items-center justify-center",n),children:e})]})}function j(){return t.jsxs("div",{className:"absolute mx-auto flex items-center gap-10 text-sm",children:[t.jsx(G,{isIndeterminate:!0,size:"sm"}),t.jsx(b,{message:"Chart loading"})]})}const W=m.memo(({code:a})=>{const{localeCode:o}=w(),s=new Intl.DisplayNames([o],{type:"region"});let e;try{e=s.of(a.toUpperCase())}catch{}return t.jsx(m.Fragment,{children:e})}),A="https://www.gstatic.com/charts/loader.js";function J({placeholderRef:a,data:o,country:s,onCountrySelected:e}){const{trans:r}=_(),{analytics:i}=E(),n=i==null?void 0:i.gchart_api_key,{selectedTheme:l}=F(),c=m.useRef(null),d=!!e&&!s,g=m.useCallback(()=>{var y,C;if(typeof google>"u")return;const f=o.map(N=>[N.label,N.value]);f.unshift([r(s?v("City"):v("Country")),r(v("Clicks"))]);const R=`${k(l.values["--be-bg-elevated"])}`,B={colorAxis:{colors:[`${k(l.values["--be-primary"])}`]},backgroundColor:R,region:s?s.toUpperCase():void 0,resolution:s?"provinces":"countries",displayMode:s?"markers":"regions",enableRegionInteractivity:d};!c.current&&a.current&&((y=google==null?void 0:google.visualization)!=null&&y.GeoChart)&&(c.current=new google.visualization.GeoChart(a.current)),(C=c.current)==null||C.draw(google.visualization.arrayToDataTable(f),B)},[l,o,a,r,s,d]),p=m.useCallback(async()=>{T.isLoadingOrLoaded(A)||(await T.loadAsset(A,{type:"js",id:"google-charts-js"}),await google.charts.load("current",{packages:["geochart"],mapsApiKey:n}),g())},[n,g]);return m.useEffect(()=>(c.current&&e&&google.visualization.events.addListener(c.current,"regionClick",f=>e==null?void 0:e(f.region)),()=>{c.current&&google.visualization.events.removeAllListeners(c.current)}),[e,c.current]),m.useEffect(()=>{p()},[p]),m.useEffect(()=>{g()},[l,g,o]),{drawGoogleChart:g}}function ie({data:a,isLoading:o,onCountrySelected:s,country:e,className:r,colSpan:i="col-span-7",rowSpan:n="row-span-11",...l}){const c=m.useRef(null),d=!!s,g=a==null?void 0:a.datasets[0].data,p=m.useMemo(()=>g||[],[g]);return J({placeholderRef:c,data:p,country:e,onCountrySelected:s}),t.jsxs($,{...l,className:h(r,i,n,"compact-scrollbar overflow-x-auto overflow-y-hidden"),title:t.jsxs("div",{className:"flex items-center",children:[t.jsx(b,{message:"Top Locations"}),e?t.jsxs("span",{className:"pl-4",children:["(",t.jsx(W,{code:e}),")"]}):null,d&&t.jsx(Z,{})]}),contentIsFlex:o,children:[o&&t.jsx(j,{}),t.jsxs("div",{className:"flex gap-24",children:[t.jsx("div",{ref:c,className:"min-h-[340px] w-[480px] flex-auto"}),t.jsxs("div",{className:"w-[170px]",children:[t.jsx("div",{className:"max-h-[340px] w-full flex-initial overflow-y-auto text-sm",children:p.map(f=>t.jsxs("div",{className:h("mb-4 flex items-center gap-4",d&&"cursor-pointer hover:underline"),role:d?"button":void 0,onClick:()=>{s==null||s(f.code)},children:[t.jsx("div",{className:"max-w-110 overflow-hidden overflow-ellipsis whitespace-nowrap",children:f.label}),t.jsxs("div",{children:["(",f.percentage,")%"]})]},f.label))}),e&&t.jsx(P,{variant:"outline",size:"xs",className:"mt-14",startIcon:t.jsx(q,{}),onClick:()=>{s==null||s(void 0)},children:t.jsx(b,{message:"Back to countries"})})]})]})]})}function Z(){return t.jsx(H,{title:t.jsx(b,{message:"Zooming in"}),body:t.jsx(b,{message:"Click on a country inside the map or country list to zoom in and see city data for that country."})})}const Q=m.lazy(()=>K(()=>import("./lazy-chart-DtVVyhzz.js"),__vite__mapDeps([0,1,2]),import.meta.url));function z(a){const{title:o,description:s,className:e,rowSpan:r="row-span-11",colSpan:i="col-span-6",contentRef:n,isLoading:l}=a;return t.jsx($,{title:o,description:s,className:h(e,r,i),contentRef:n,children:t.jsxs(m.Suspense,{fallback:t.jsx(j,{}),children:[t.jsx(Q,{...a}),l&&t.jsx(j,{})]})})}function I(a,{localeCode:o="en",shareFirstDatasetLabels:s=!0}){if(!a)return{datasets:[]};const e=[];return{...a,datasets:a.datasets.map((r,i)=>{const n=r.data.map((l,c)=>{let d;return i===0||!s?(d=X(l,a.granularity,o),e[c]=d):d=e[c],{...d,value:l.value}});return{...r,data:n}})}}function X(a,o,s){return a.label?{label:a.label}:a.date?Y(a,o,s):{label:""}}function Y({date:a,endDate:o},s="day",e){const r=L(a).toDate(),i=o?L(o).toDate():null;switch(s){case"minute":return{label:u(e,{second:"2-digit"}).format(r),tooltipTitle:u(e,{day:"2-digit",hour:"numeric",minute:"numeric",second:"2-digit"}).format(r)};case"hour":return{label:u(e,{hour:"numeric",minute:"numeric"}).format(r),tooltipTitle:u(e,{month:"short",day:"2-digit",hour:"numeric",minute:"numeric"}).format(r)};case"day":return{label:u(e,{day:"2-digit",weekday:"short"}).format(r),tooltipTitle:u(e,{day:"2-digit",weekday:"short",month:"short"}).format(r)};case"week":return{label:u(e,{month:"short",day:"2-digit"}).format(r),tooltipTitle:u(e,{day:"2-digit",month:"long",year:"numeric"}).formatRange(r,i)};case"month":return{label:u(e,{month:"short",year:"numeric"}).format(r),tooltipTitle:u(e,{month:"long",year:"numeric"}).format(r)};case"year":return{label:u(e,{year:"numeric"}).format(r),tooltipTitle:u(e,{year:"numeric"}).format(r)}}}const u=M((a,o)=>new V(a,o),{equals:(a,o)=>O(a,o)}),D=U().themes[0].values["--be-primary"],x=[[`rgb(${D.replaceAll(" ",",")})`,`rgba(${D.replaceAll(" ",",")},0.2)`],["rgb(255,112,67)","rgb(255,112,67,0.2)"],["rgb(255,167,38)","rgb(255,167,38,0.2)"],["rgb(141,110,99)","rgb(141,110,99,0.2)"],["rgb(102,187,106)","rgba(102,187,106,0.2)"],["rgb(92,107,192)","rgb(92,107,192,0.2)"]],S={parsing:{xAxisKey:"label",yAxisKey:"value"},datasets:{line:{fill:"origin",tension:.1,pointBorderWidth:4,pointHitRadius:10}},plugins:{tooltip:{intersect:!1,mode:"index"}}};function ne({data:a,...o}){const{localeCode:s}=w(),e=m.useMemo(()=>{const r=I(a,{localeCode:s});return r.datasets=r.datasets.map((i,n)=>({...i,backgroundColor:x[n][1],borderColor:x[n][0],pointBackgroundColor:x[n][0]})),r},[a,s]);return t.jsx(z,{...o,data:e,type:"line",options:S})}const ee={parsing:{key:"value"},plugins:{tooltip:{intersect:!0}}};function le({data:a,className:o,...s}){const{localeCode:e}=w(),r=m.useMemo(()=>{var n;const i=I(a,{localeCode:e});return i.labels=(n=i.datasets[0])==null?void 0:n.data.map(l=>l.label),i.datasets=i.datasets.map((l,c)=>({...l,backgroundColor:x.map(d=>d[1]),borderColor:x.map(d=>d[0]),borderWidth:2})),i},[a,e]);return t.jsx(z,{type:"polarArea",data:r,options:ee,className:o,...s})}export{z as B,x as C,ie as G,ne as L,le as P,$ as a,j as b,I as f};
