import{ae as u,G as l,ag as m,H as c,I as d,J as p,aa as h,b as x,w as j,j as t,as as U,r as f,e as v,Q as F,c1 as S,T as i}from"./main-CUJEGI8U.js";import{D as b,b as y}from"./crupdate-resource-layout-D1LYHbcS.js";import{u as g}from"./use-normalized-models-ClA2DWxP.js";import{F as w}from"./form-chip-field-ehb7ckkp.js";function C(r,e){const a=u();return l({mutationFn:s=>E(r,s),onSuccess:()=>{d(p("User updated")),h.invalidateQueries({queryKey:["users"]}),a("../..",{relative:"path"})},onError:s=>e?m(s,e):c(s)})}function E(r,e){return e.roles&&(e.roles=e.roles.map(a=>a.id)),x.put(`users/${r}`,e).then(a=>a.data)}function A({form:r,children:e}){const a=j(),s=C(a.id,r);return t.jsxs(U,{onSubmit:n=>{s.mutate(n)},onBeforeSubmit:()=>r.clearErrors(),form:r,children:[e,t.jsx(b,{isLoading:s.isPending})]})}function D({endpoint:r}){const[e,a]=f.useState(""),{data:s}=g(r??"normalized-models/role",{query:e}),{hasPermission:n}=v();return t.jsx(y,{label:t.jsx(i,{message:"Roles"}),children:t.jsx(w,{className:"mb-30",name:"roles",suggestions:s==null?void 0:s.results,inputValue:e,onInputValueChange:a,alwaysShowAvatar:!0,readOnly:!n("users.update"),description:t.jsx(i,{message:"User will inherit all permissions from the roles they are assigned."}),children:o=>t.jsx(F,{value:o.id,startIcon:t.jsx(S,{label:o.name}),children:o.name},o.id)})})}export{A as U,D as a};
