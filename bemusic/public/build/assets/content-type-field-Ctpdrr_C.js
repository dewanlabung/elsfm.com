import{P as h,j as e,d as M,Q as m,T as c,r as p,V as w,u as S,J as n,z as _,a7 as k,aq as O,ar as D,t as R}from"./main-CUJEGI8U.js";import{F as j}from"./select-Z9R0wV6S.js";import{I as N}from"./info-dialog-trigger-CfT6LuLX.js";import{C as E}from"./channels-docs-link-CASgP5UZ.js";import{G as I}from"./genre-B_3ZyEC1.js";import{A as q}from"./album-C9ItuPVf.js";import{A as z}from"./artist-C2fP4kQS.js";import{P as B}from"./playlist-BqUIfvab.js";import{T as H}from"./track-BCLqLBLk.js";import{C as K}from"./channel-CQzLS58I.js";import{G as Q}from"./GridView-Dh9DCz0C.js";import{V as $,a as J,b as W}from"./ViewWeek-Tba7Fzg3.js";import{U as Y}from"./user-D6GCMJ6c.js";import{L as Z}from"./Link-CxMKoj6l.js";function X({config:t,className:i,providers:a}){var l;const{watch:o,setValue:u}=h(),r=t.models[o("config.contentModel")],s=t.autoUpdateMethods[o("config.autoUpdateMethod")];return o("config.contentType")!=="autoUpdate"||!((l=r.autoUpdateMethods)!=null&&l.length)?null:e.jsxs("div",{className:M("items-end gap-14 md:flex",i),children:[e.jsx(j,{required:!0,className:"flex-auto",selectionMode:"single",name:"config.autoUpdateMethod",onSelectionChange:d=>{u("config.autoUpdateProvider",t.autoUpdateMethods[d].providers[0])},label:e.jsxs(p.Fragment,{children:[e.jsx(c,{message:"Auto update method"}),e.jsx(N,{body:e.jsxs(p.Fragment,{children:[e.jsx("div",{className:"mb-20",children:e.jsx(c,{message:"This option will automatically update channel content every 24 hours using the specified method."})}),e.jsx(E,{hash:"automatically-update-content-with-specified-method"})]})})]}),children:r.autoUpdateMethods.map(d=>e.jsx(m,{value:d,children:e.jsx(c,{...t.autoUpdateMethods[d].label})},d))}),s!=null&&s.value?e.jsx(w,{name:"config.autoUpdateValue",required:!0,className:"flex-auto",label:e.jsx(c,{...s==null?void 0:s.value.label}),type:s==null?void 0:s.value.inputType}):null,a!=null&&a.length?e.jsx(j,{selectionMode:"single",className:"mt-24 flex-auto md:mt-0",name:"config.autoUpdateProvider",label:e.jsx(c,{message:"Fetch content from"}),required:!0,children:a.filter(d=>s==null?void 0:s.providers.includes(d.value)).map(d=>e.jsx(m,{value:d.value,children:e.jsx(c,{...d.label})},d.value))}):null]})}function Ue({className:t,config:i}){const{spotify_is_setup:a,lastfm_is_setup:o}=S(),u=p.useMemo(()=>{const r=[{label:n("Local database"),value:"local"}];return a&&r.push({label:n("Spotify"),value:"spotify"}),o&&r.push({label:n("Last.fm"),value:"lastfm"}),r},[a,o]);return e.jsx(X,{config:i,providers:u,className:t})}function ee({config:t,className:i,children:a}){const{setValue:o}=h(),{watch:u}=h(),r=t.models[u("config.contentModel")],s=u("config.contentType");return!r.restrictions||s==="manual"?null:e.jsxs("div",{className:M("items-end gap-14 md:flex",i),children:[e.jsxs(j,{className:"w-full flex-auto",name:"config.restriction",selectionMode:"single",label:e.jsxs(p.Fragment,{children:[e.jsx(c,{message:"Filter content by"}),e.jsx(te,{})]}),onSelectionChange:()=>{o("config.restrictionModelId","urlParam")},children:[e.jsx(m,{value:null,children:e.jsx(c,{message:"Don't filter content"})}),Object.values(t.restrictions).map(l=>e.jsx(m,{value:l.value,children:e.jsx(c,{...l.label})},l.value))]}),a]})}function te(){return e.jsx(N,{body:e.jsxs(p.Fragment,{children:[e.jsx(c,{message:"Allows specifying additional condition channel content should be filtered on. "}),e.jsx(E,{className:"mt-20",hash:"filter-content-by"})]})})}function Le({className:t,config:i}){const{watch:a}=h();return a("config.contentType")!=="listAll"?null:e.jsx(ee,{config:i,className:t,children:e.jsx(se,{config:i})})}function se({config:t}){var f,v;const{trans:i}=_(),[a,o]=p.useState(""),{watch:u}=h(),r=u("config.restrictionModelId"),s=k(["genres"],{searchQuery:a,selectedValue:r,type:u("config.autoUpdateProvider")}),l=u("config.restriction");if(!l)return null;const d={[I]:(f=s.data)==null?void 0:f.genres},g=t.restrictions[l].label;return e.jsxs(j,{className:"w-full flex-auto",name:"config.restrictionModelId",selectionMode:"single",showSearchField:!0,searchPlaceholder:i(n("Search...")),isAsync:l==="genre",isLoading:l==="genre"&&s.isLoading,inputValue:a,onInputValueChange:o,label:e.jsx(c,{message:":restriction name",values:{restriction:i(g)}}),children:[e.jsx(m,{value:"urlParam",children:e.jsx(c,{message:"Dynamic (from url)"})}),(v=d[l])==null?void 0:v.map(x=>e.jsx(m,{value:x.value,children:e.jsx(c,{message:x.name})},x.value))]})}const ae={[z]:{label:n("Artists"),sortMethods:["popularity:desc","created_at:desc","id:asc"],layoutMethods:["grid","compactGrid","carousel"],autoUpdateMethods:["topArtists"],restrictions:["genre"]},[q]:{label:n("Albums"),sortMethods:["popularity:desc","created_at:desc","release_date:desc","id:asc"],layoutMethods:["grid","compactGrid","list","carousel"],autoUpdateMethods:["newAlbums","topAlbums"],restrictions:["genre"]},[H]:{label:n("Tracks"),sortMethods:["popularity:desc","created_at:desc","id:asc"],layoutMethods:["grid","compactGrid","trackTable","list","carousel"],autoUpdateMethods:["topTracks","playlistTracks"],restrictions:["genre"]},[B]:{label:n("Playlists"),sortMethods:["popularity:desc","created_at:desc","id:asc"],layoutMethods:["grid","compactGrid","carousel"]},[Y]:{label:n("Users"),sortMethods:["created_at:desc","id:asc"],layoutMethods:["grid","carousel"],autoUpdateMethods:[]},[I]:{label:n("Genres"),sortMethods:["popularity:desc","created_at:desc","id:asc"],layoutMethods:["grid","carousel","compactGrid"],autoUpdateMethods:["topGenres","nonEmptyGenres"]},[K]:{label:n("Channels"),sortMethods:[],layoutMethods:["list"]}},oe={"popularity:desc":{label:n("Most popular first")},"created_at:desc":{label:n("Recently added first")},"id:asc":{label:n("Oldest first")},"channelables.order:asc":{label:n("Curated (reorder below)"),contentTypes:["manual"]},"channelables.created_at:desc":{label:n("Recently attached first")},"release_date:desc":{label:n("Most recent first (by release date)")}},ne={grid:{label:n("Grid"),icon:e.jsx(Q,{})},trackTable:{label:n("Table"),icon:e.jsx(W,{})},list:{label:n("List"),icon:e.jsx(J,{})},carousel:{label:n("Carousel")},compactGrid:{label:n("Compact grid"),icon:e.jsx($,{})}},le={topTracks:{label:n("Top tracks"),providers:["spotify","local"]},newAlbums:{label:n("New releases"),providers:["spotify","local"]},topAlbums:{label:n("Popular albums"),providers:["spotify","local"]},topArtists:{label:n("Popular artists"),providers:["spotify","local"]},playlistTracks:{label:n("Playlist tracks"),providers:["spotify","local"],value:{label:n("Playlist ID"),inputType:"text"}},topGenres:{label:n("Popular genres"),providers:["lastfm","local"]},nonEmptyGenres:{label:n("Genres that have content"),providers:["local"]}},ie={genre:{label:n("Genre"),value:"genre"}},Ae={models:ae,sortingMethods:oe,layoutMethods:ne,autoUpdateMethods:le,userSelectableLayouts:["grid","trackTable","list"],restrictions:ie};function re({host:t,value:i="",placeholder:a,onChange:o,className:u,inputRef:r,onInputBlur:s,showLinkIcon:l=!0,pattern:d,minLength:g,maxLength:f,hideButton:v,...x}){const{base_url:G}=S(),P=x.prefix?`/${x.prefix}`:"",V=x.suffix?`/${x.suffix}`:"",[b,L]=p.useState(!1),[y,A]=p.useState(i);t=t||G,p.useEffect(()=>{A(i)},[i]);const F=()=>{b?(L(!1),y&&(o==null||o(y))):L(!0)};let T="";return y?T=y:a&&(T=O(a)),e.jsxs("div",{className:M("flex items-center",u),children:[l&&e.jsx(Z,{className:"text-muted icon-md"}),e.jsxs("div",{className:"ml-6 mr-14 text-primary",children:[t,P,!b&&T&&e.jsxs(p.Fragment,{children:[e.jsx("span",{children:"/"}),e.jsx("span",{className:"font-medium",children:T})]}),b?null:V]}),b&&e.jsx(D,{pattern:d,minLength:g,maxLength:f,onKeyDown:U=>{U.key==="Enter"&&F()},ref:r,"aria-label":"slug",autoFocus:!0,className:"mr-14",size:"2xs",value:y,onBlur:s,onChange:U=>{A(U.target.value)}}),!v&&e.jsx(R,{type:"button",color:"chip",variant:"outline",size:"2xs",onClick:()=>{F()},children:b?e.jsx(c,{message:"Save"}):e.jsx(c,{message:"Edit"})})]})}function Fe({className:t,autoFocus:i}){return e.jsxs(p.Fragment,{children:[e.jsx(w,{name:"name",label:e.jsx(c,{message:"Title"}),required:!0,autoFocus:i,className:M("mb-10",t)}),e.jsx(ce,{})]})}function ce(){const{watch:t,setValue:i}=h(),a=t("slug"),o=t("name"),u=t("config.lockSlug"),r=t("config.restriction"),s=t("config.restrictionModelId"),{trans:l}=_();return e.jsx(re,{hideButton:u,placeholder:o,suffix:r&&s==="urlParam"?l(n(":restriction_name",{values:{restriction:r}})):void 0,className:"text-sm",pattern:"[A-Za-z0-9_-]+",minLength:3,maxLength:20,value:a,onChange:d=>{i("slug",d)}})}function Ce({config:t,className:i}){return e.jsxs("div",{className:M("items-end gap-14 md:flex",i),children:[e.jsx(C,{config:t,name:"config.layout",label:e.jsx(c,{message:"Layout"})}),e.jsx(C,{config:t,name:"config.nestedLayout",label:e.jsx(c,{message:"Layout when nested"})})]})}function C({config:t,name:i,label:a}){var s;const{watch:o}=h(),u=o("config.contentModel"),r=t.models[u];return(s=r.layoutMethods)!=null&&s.length?e.jsx(j,{className:"w-full flex-auto",selectionMode:"single",name:i,label:a,children:r.layoutMethods.map(l=>{const d=t.layoutMethods[l].label;return e.jsx(m,{value:l,children:e.jsx(c,{...d})},l)})}):null}function we({config:t,className:i,exclude:a}){const{setValue:o,getValues:u}=h();return e.jsx(j,{className:i,selectionMode:"single",name:"config.contentModel",label:e.jsx(c,{message:"Type of content"}),onSelectionChange:r=>{var d,g,f;const s=t.models[r];u("config.contentType")==="autoUpdate"&&!((d=s.autoUpdateMethods)!=null&&d.length)&&o("config.contentType","manual");const l=(g=s.autoUpdateMethods)==null?void 0:g[0];o("config.autoUpdateMethod",l),o("config.autoUpdateProvider",l?(f=t.autoUpdateMethods[l])==null?void 0:f.providers[0]:void 0),o("config.restriction",null),o("config.restrictionModelId",null),o("config.contentOrder",s.sortMethods[0]||"channelables.order:asc"),o("config.layout",s.layoutMethods[0])},children:Object.entries(t.models).filter(([r])=>!(a!=null&&a.includes(r))).map(([r,{label:s}])=>e.jsx(m,{value:r,children:e.jsx(c,{...s})},r))})}function Se({config:t,className:i}){const{watch:a}=h(),o=a("config.contentType"),r=[...t.models[a("config.contentModel")].sortMethods,"channelables.order:asc","channelables.created_at:desc"];return e.jsx(j,{className:i,selectionMode:"single",name:"config.contentOrder",label:e.jsx(c,{message:"How to order content"}),children:r.map(s=>{const l=t.sortingMethods[s];if(!l.contentTypes||l.contentTypes.includes(o))return e.jsx(m,{value:s,children:e.jsx(c,{...l.label})},s)})})}function _e({config:t,className:i}){const{setValue:a}=h();return e.jsxs(j,{className:i,selectionMode:"single",name:"config.contentType",label:e.jsx(c,{message:"Content"}),onSelectionChange:o=>{var l;let u=Object.entries(t.models)[0];if(o==="autoUpdate"){const d=Object.entries(t.models).find(([,g])=>{var f;return(f=g.autoUpdateMethods)==null?void 0:f.length});d&&(u=d)}const[r,s]=u;a("config.contentModel",r),a("config.restrictionModelId",void 0),a("config.autoUpdateMethod",o==="autoUpdate"?(l=s.autoUpdateMethods)==null?void 0:l[0]:""),a("config.contentOrder",s.sortMethods[0]),a("config.restriction",null)},children:[e.jsx(m,{value:"listAll",children:e.jsx(c,{message:"List all content of specified type"})}),e.jsx(m,{value:"manual",children:e.jsx(c,{message:"Manage content manually"})}),e.jsx(m,{value:"autoUpdate",children:e.jsx(c,{message:"Automatically update content with specified method"})})]})}export{Ue as A,Fe as C,_e as a,we as b,Ae as c,Le as d,Se as e,Ce as f};
